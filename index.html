<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<!-- ========== Link Preview ========== -->
 <title>رعد ⚡ | تطبيق إسلامي متكامل</title>
<meta name="description" content="موقع إسلامي شامل يحتوي على القرآن الكريم، أوقات الصلاة، الأذكار، المسبحة، والمقالات الإسلامية.">

<meta property="og:title" content="القرآن الكريم - أوقات الصلاة والأذكار">
<meta property="og:description" content="استمع للقرآن الكريم وتابع أوقات الصلاة والأذكار والمقالات الإسلامية بسهولة.">
<meta property="og:image" content="https://mj69077.github.io/ra3d/preview.jpg">
<meta property="og:url" content="https://mj69077.github.io/ra3d/">
<meta property="og:type" content="website">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="القرآن الكريم - أوقات الصلاة والأذكار">
<meta name="twitter:description" content="استمع للقرآن الكريم وتابع أوقات الصلاة والأذكار والمقالات الإسلامية بسهولة.">
<meta name="twitter:image" content="https://mj69077.github.io/ra3d/preview.jpg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --gold: #FFD700;
            --dark-gold: #b8860b;
            --bg: #0a0a0a;
            --card: #161616;
            --text: #FFD700;
            --light-text: #f8f9fa;
            --border: #333;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Amiri', serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 80px;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
        }
        
        h1 {
            text-align: center;
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--gold);
        }
        
        .subtitle {
            text-align: center;
            color: var(--light-text);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        /* ========== شاشة التحميل مع الثيم ========== */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .loading-content {
            text-align: center;
            padding: 20px;
            max-width: 500px;
        }
        
        .loading-icon {
            font-size: 4rem;
            color: var(--gold);
            margin-bottom: 20px;
            animation: pulse 1.5s infinite;
        }
        
        .loading-title {
            font-family: 'Reem Kufi', sans-serif;
            color: var(--gold);
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: var(--light-text);
            font-size: 1.1rem;
        }
        
        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .loading-progress-fill {
            height: 100%;
            background: var(--gold);
            width: 0%;
            animation: loading 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        @keyframes loading {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        /* ========== التنقل ========== */
        nav {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 8px;
            margin-bottom: 20px;
            background: var(--card);
            padding: 10px;
            border-radius: 15px;
            border: 1px solid var(--border);
        }
        
        nav button {
            background: transparent;
            border: none;
            color: var(--text);
            padding: 12px 5px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        nav button.active {
            background: var(--gold);
            color: black;
            font-weight: bold;
        }
        
        nav button:hover:not(.active) {
            background: rgba(255, 215, 0, 0.1);
        }
        
        /* ========== الأقسام ========== */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .active-section {
            display: block;
        }
        
        /* ========== البطاقات العامة ========== */
        .card {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid var(--border);
            transition: all 0.3s;
        }
        
        .card:hover {
            border-color: var(--gold);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        /* ========== القرآن الكريم ========== */
        .quran-section {
            padding: 20px;
        }
        
        .surahs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .surah-card {
            background: var(--card);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .surah-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
        }
        
        .surah-number {
            background: var(--gold);
            color: black;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }
        
        /* ========== تفاصيل السورة ========== */
        .surah-details {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }
        
        .surah-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gold);
        }
        
        .surah-content {
            font-size: 1.8rem;
            line-height: 2.5;
            text-align: center;
            color: var(--light-text);
            margin-bottom: 20px;
        }
        
        .ayah-number {
            color: var(--gold);
            display: inline-block;
            margin: 0 5px;
            font-size: 1rem;
        }
        
        /* ========== مشغل القرآن الصوتي ========== */
        .audio-player {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            position: relative;
        }
        
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        
        .audio-btn {
            background: var(--gold);
            color: black;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .audio-btn:hover {
            background: var(--dark-gold);
            transform: scale(1.1);
        }
        
        .audio-progress {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }
        
        .audio-progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--gold);
            width: 0%;
            transition: width 0.1s;
        }
        
        .audio-time {
            color: var(--light-text);
            font-size: 0.9rem;
            min-width: 100px;
            text-align: center;
        }
        
        .reciter-selector {
            margin-top: 10px;
        }
        
        .reciter-selector select {
            width: 100%;
            background: var(--card);
            color: var(--text);
            border: 1px solid var(--gold);
            border-radius: 8px;
            padding: 8px;
            font-size: 1rem;
        }
        
        /* ========== بحث الآيات ========== */
        .ayah-search-results {
            margin-top: 20px;
        }
        
        .ayah-result-card {
            background: rgba(255, 215, 0, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            transition: all 0.3s;
        }
        
        .ayah-result-card:hover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }
        
        .ayah-result-content {
            font-size: 1.8rem;
            line-height: 2;
            text-align: center;
            margin-bottom: 15px;
            color: var(--light-text);
        }
        
        .ayah-result-info {
            display: flex;
            justify-content: space-between;
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 215, 0, 0.1);
        }
        
        /* ========== إذاعة القرآن الكريم ========== */
        .radio-section {
            padding: 20px;
        }
        
        .radio-stations {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .radio-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .radio-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
        }
        
        .radio-card.active {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }
        
        .radio-icon {
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 15px;
        }
        
        .radio-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }
        
        /* ========== المقالات الإسلامية ========== */
        .articles-section {
            padding: 20px;
        }
        
        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .article-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .article-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
        }
        
        .article-category {
            background: var(--gold);
            color: black;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .article-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--light-text);
        }
        
        .article-excerpt {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .article-meta {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.8rem;
        }
        
        /* ========== المسبحة ========== */
        .tasbih-section {
            padding: 20px;
            text-align: center;
        }
        
        .counter-display {
            font-size: 8rem;
            font-weight: bold;
            color: var(--gold);
            margin: 30px 0;
            font-family: 'Reem Kufi';
        }
        
        .counter-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .counter-btn {
            background: var(--card);
            border: 3px solid var(--gold);
            color: var(--text);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            font-size: 2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .counter-btn:hover {
            background: var(--gold);
            color: black;
            transform: scale(1.1);
        }
        
        /* ========== الأذكار ========== */
        .azkar-section {
            padding: 20px;
        }
        
        .azkar-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding: 10px 0;
        }
        
        .azkar-tab {
            background: var(--card);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .azkar-tab:hover {
            border-color: var(--gold);
        }
        
        .azkar-tab.active {
            background: var(--gold);
            color: black;
            border-color: var(--gold);
            font-weight: bold;
        }
        
        .azkar-content {
            min-height: 200px;
        }
        
        /* ========== الأحاديث ========== */
        .hadith-card {
            position: relative;
        }
        
        .hadith-text {
            font-size: 1.4rem;
            line-height: 2;
            margin-bottom: 15px;
            color: var(--light-text);
            text-align: center;
        }
        
        .hadith-reference {
            text-align: left;
            color: #aaa;
            direction: ltr;
            text-align: right;
        }
        
        /* ========== أسماء الله الحسنى ========== */
        .asma-section {
            padding: 20px;
        }
        
        .asma-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .asma-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .asma-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
        }
        
        .asma-name-arabic {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--gold);
        }
        
        /* ========== الصلاة ========== */
        .prayer-times {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .prayer-time-card {
            background: rgba(255, 215, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
            border: 1px solid var(--border);
        }
        
        .prayer-time-card:hover {
            transform: translateY(-3px);
        }
        
        .prayer-time-card.current {
            background: var(--gold);
            color: black;
            transform: scale(1.05);
            border-color: var(--gold);
        }
        
        .prayer-time-card .time {
            font-size: 1.8rem;
            color: var(--gold);
            margin-bottom: 5px;
        }
        
        .prayer-time-card.current .time {
            color: black;
        }
        
        /* ========== القبلة ========== */
        .qibla-section {
            text-align: center;
            padding: 20px;
        }
        
        .qibla-compass {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }
        
        .compass-circle {
            width: 100%;
            height: 100%;
            border: 3px solid var(--gold);
            border-radius: 50%;
            position: relative;
            background: var(--card);
        }
        
        .compass-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: left center;
            transition: transform 0.5s ease;
        }
        
        .needle {
            width: 150px;
            height: 4px;
            background: #e74c3c;
            position: relative;
        }
        
        .needle::after {
            content: '';
            position: absolute;
            right: 0;
            top: -8px;
            width: 20px;
            height: 20px;
            background: var(--gold);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }
        
        .qibla-direction {
            font-size: 2rem;
            color: var(--gold);
            margin: 20px 0;
        }
        
        /* ========== السمات ========== */
        .theme-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .theme-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            text-align: center;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .theme-card:hover {
            transform: translateY(-5px);
        }
        
        .theme-card.active {
            border-color: var(--gold);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .theme-preview {
            width: 100%;
            height: 50px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        /* ========== الفوتر ========== */
        .footer-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card);
            border-top: 2px solid var(--gold);
            padding: 10px;
            display: flex;
            justify-content: space-around;
            z-index: 1000;
        }
        
        .footer-btn {
            background: transparent;
            border: none;
            color: var(--text);
            padding: 10px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .footer-btn:hover {
            color: var(--gold);
        }
        
        .footer-btn.active {
            color: var(--gold);
            font-weight: bold;
        }
        
        /* ========== أزرار ========== */
        .btn {
            background: var(--gold);
            color: black;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: var(--dark-gold);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background: var(--card);
            color: var(--text);
            border: 1px solid var(--gold);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 215, 0, 0.1);
        }
        
        /* ========== تأثير الزجاجي Glassmorphism ========== */
        .card.glass-effect {
            background: rgba(22, 22, 22, 0.7) !important;
            backdrop-filter: blur(10px) saturate(180%);
            -webkit-backdrop-filter: blur(10px) saturate(180%);
            border: 1px solid rgba(255, 215, 0, 0.2) !important;
            box-shadow: 
                0 8px 32px 0 rgba(0, 0, 0, 0.37),
                0 0 0 1px rgba(255, 215, 0, 0.1),
                inset 0 0 20px rgba(255, 215, 0, 0.05);
            position: relative;
            z-index: 1;
        }
        
        .card.glass-effect:hover {
            background: rgba(25, 25, 25, 0.8) !important;
            border-color: rgba(255, 215, 0, 0.3) !important;
            box-shadow: 
                0 12px 40px 0 rgba(0, 0, 0, 0.45),
                0 0 0 1px rgba(255, 215, 0, 0.2),
                inset 0 0 30px rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
        }
        
        /* ========== استجابة ========== */
        @media (max-width: 768px) {
            nav {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .counter-display {
                font-size: 6rem;
            }
            
            .counter-btn {
                width: 70px;
                height: 70px;
                font-size: 1.8rem;
            }
            
            .surahs-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .surah-content {
                font-size: 1.5rem;
                line-height: 2;
            }
            
            .theme-selector {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .loading-icon {
                font-size: 3rem;
            }
            
            .loading-title {
                font-size: 2rem;
            }
        }
        
        @media (max-width: 480px) {
            nav {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .counter-display {
                font-size: 5rem;
            }
            
            .counter-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .prayer-times {
                grid-template-columns: 1fr;
            }
            
            .theme-selector {
                grid-template-columns: 1fr;
            }
            
            .loading-icon {
                font-size: 2.5rem;
            }
            
            .loading-title {
                font-size: 1.8rem;
            }
        }
        
        /* ========== السمات الأساسية ========== */
        .theme-gold {
            --gold: #FFD700;
            --dark-gold: #b8860b;
            --bg: #0a0a0a;
            --card: #161616;
            --text: #FFD700;
            --light-text: #f8f9fa;
            --border: #333;
        }
        
        .theme-green {
            --gold: #27ae60;
            --dark-gold: #229954;
            --bg: #0a140a;
            --card: #1a2c1a;
            --text: #27ae60;
            --light-text: #e8f5e9;
            --border: #2e7d32;
        }
        
        .theme-blue {
            --gold: #3498db;
            --dark-gold: #2980b9;
            --bg: #0a0a14;
            --card: #1a1a2c;
            --text: #3498db;
            --light-text: #e3f2fd;
            --border: #1565c0;
        }
        
        .theme-purple {
            --gold: #9b59b6;
            --dark-gold: #8e44ad;
            --bg: #140a14;
            --card: #2c1a2c;
            --text: #9b59b6;
            --light-text: #f3e5f5;
            --border: #7b1fa2;
        }
        
        /* ========== السمات الجديدة ========== */
        .theme-brown {
            --gold: #8B4513;
            --dark-gold: #654321;
            --bg: #1a120a;
            --card: #2c241a;
            --text: #8B4513;
            --light-text: #efebe9;
            --border: #5d4037;
        }
        
        .theme-pink {
            --gold: #e91e63;
            --dark-gold: #c2185b;
            --bg: #140a0f;
            --card: #2c1a24;
            --text: #e91e63;
            --light-text: #fce4ec;
            --border: #ad1457;
        }
        
        .theme-red {
            --gold: #e74c3c;
            --dark-gold: #c0392b;
            --bg: #140a0a;
            --card: #2c1a1a;
            --text: #e74c3c;
            --light-text: #ffebee;
            --border: #c62828;
        }
        
        .theme-yellow {
            --gold: #f1c40f;
            --dark-gold: #f39c12;
            --bg: #14140a;
            --card: #2c2c1a;
            --text: #f1c40f;
            --light-text: #fffde7;
            --border: #f57f17;
        }
        
        .theme-orange {
            --gold: #e67e22;
            --dark-gold: #d35400;
            --bg: #140f0a;
            --card: #2c241a;
            --text: #e67e22;
            --light-text: #fff3e0;
            --border: #ef6c00;
        }
        
        .theme-white {
            --gold: #2c3e50;
            --dark-gold: #34495e;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #2c3e50;
            --light-text: #212529;
            --border: #dee2e6;
        }
        
        .theme-gray {
            --gold: #7f8c8d;
            --dark-gold: #636e72;
            --bg: #2c3e50;
            --card: #34495e;
            --text: #ecf0f1;
            --light-text: #ffffff;
            --border: #4a6572;
        }
        
        .theme-cherry {
            --gold: #e84393;
            --dark-gold: #fd79a8;
            --bg: #1a0f14;
            --card: #2c1a24;
            --text: #e84393;
            --light-text: #fce4ec;
            --border: #d81b60;
        }
        
        .theme-wine {
            --gold: #6d214f;
            --dark-gold: #5e0d4a;
            --bg: #0f0a0f;
            --card: #1a141a;
            --text: #b33971;
            --light-text: #f8bbd0;
            --border: #8e44ad;
        }
        
        .theme-icy {
            --gold: #74b9ff;
            --dark-gold: #0984e3;
            --bg: #0a141f;
            --card: #1a2c3c;
            --text: #74b9ff;
            --light-text: #e3f2fd;
            --border: #3498db;
        }
        
        /* ========== إشعارات ========== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card);
            border: 2px solid var(--gold);
            border-radius: 10px;
            padding: 15px 25px;
            z-index: 10001;
            max-width: 300px;
            animation: slideIn 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* ========== خيارات أوقات الصلاة ========== */
        .prayer-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .prayer-method-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .prayer-method-card:hover {
            border-color: var(--gold);
            transform: translateY(-3px);
        }
        
        .prayer-method-card.active {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }
        
        .prayer-method-icon {
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 10px;
        }
        
        /* ========== مدخلات الموقع ========== */
        .location-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .location-inputs input {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            padding: 10px;
            font-size: 1rem;
        }
        
        .location-inputs input:focus {
            outline: none;
            border-color: var(--gold);
        }
        
        /* ========== شريط البحث ========== */
        .search-box {
            margin: 20px 0;
        }
        
        .search-box input {
            width: 100%;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            padding: 12px 20px;
            font-size: 1rem;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--gold);
        }
        
        /* ========== أزرار التصفية ========== */
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-btn:hover {
            border-color: var(--gold);
        }
        
        .filter-btn.active {
            background: var(--gold);
            color: black;
            border-color: var(--gold);
        }
        
        /* ========== أزرار العداد ========== */
        .count-btn {
            background: var(--card);
            border: 1px solid var(--border);
            color: var(--text);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .count-btn:hover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.1);
        }
        
        .count-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .current-count {
            font-size: 1.2rem;
            color: var(--gold);
        }
        
        .azkar-counter {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gold);
            width: 0%;
            transition: width 0.3s;
        }
        
        /* ========== قسم الأحكام ========== */
        .fatawa-section {
            padding: 20px;
        }
        
        .fatawa-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .fatawa-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .fatawa-card:hover {
            border-color: var(--gold);
            transform: translateY(-5px);
        }
        
        .fatawa-category {
            background: var(--gold);
            color: black;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .fatawa-question {
            font-size: 1.2rem;
            color: var(--light-text);
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .fatawa-details {
            color: #aaa;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            margin-top: auto;
        }
        
        /* ========== تفاصيل الحكم الشرعي ========== */
        .fatawa-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1001;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .fatawa-detail-content {
            background: var(--card);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid var(--gold);
            position: relative;
        }
        
        .fatawa-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gold);
        }
        
        .fatawa-answer {
            color: var(--light-text);
            line-height: 1.8;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .fatawa-source {
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .search-history {
            margin-top: 30px;
        }
        
        .history-item {
            background: var(--card);
            border-radius: 10px;
            padding: 10px 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--border);
        }
        
        .history-item:hover {
            border-color: var(--gold);
        }
        
        /* ========== البحث عن الآيات ========== */
        .ayah-search-section {
            margin-bottom: 30px;
        }
        
        .ayah-search-results-container {
            margin-top: 20px;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #aaa;
            font-size: 1.1rem;
        }
    </style>
</head>
<body class="theme-gold">
    <!-- شاشة التحميل -->
    <div id="loadingScreen">
        <div class="loading-content">
            <div class="loading-icon">
                <i class="fas fa-mosque"></i>
            </div>
            <h1 class="loading-title">رعد</h1>
            <p class="loading-text">جاري تحميل التطبيق...</p>
            <div class="loading-progress">
                <div class="loading-progress-fill"></div>
            </div>
        </div>
    </div>
    
    <!-- تفاصيل السورة -->
    <div id="surahDetails" class="surah-details">
        <div class="container">
            <div class="surah-header">
                <h2 id="surahTitle">سورة الفاتحة</h2>
                <button class="btn btn-secondary" onclick="closeSurahDetails()">
                    <i class="fas fa-times"></i> إغلاق
                </button>
            </div>
            
            <div class="card glass-effect">
                <div id="surahInfo" style="color: #aaa; margin-bottom: 20px; text-align: center;">
                    مكية | 7 آيات
                </div>
                
                <div id="surahText" class="surah-content">
                    <!-- سيتم تحميل الآيات هنا -->
                </div>
                
                <!-- مشغل القرآن الصوتي -->
                <div id="audioPlayer" class="audio-player" style="display: none;">
                    <div style="color: var(--gold); margin-bottom: 10px; text-align: center;">
                        <i class="fas fa-music"></i> استماع إلى السورة
                    </div>
                    <div class="reciter-selector">
                        <select id="reciterSelect" onchange="changeReciter()">
                            <option value="1">ماهر المعيقلي</option>
                            <option value="2">محمد صديق المنشاوي</option>
                            <option value="3">عبد الباسط عبد الصمد</option>
                            <option value="4">محمود خليل الحصري</option>
                        </select>
                    </div>
                    <div class="audio-controls">
                        <button class="audio-btn" onclick="playPauseAudio()" id="playPauseBtn">
                            <i class="fas fa-play"></i>
                        </button>
                        <div class="audio-progress" onclick="seekAudio(event)">
                            <div class="audio-progress-fill" id="audioProgress"></div>
                        </div>
                        <div class="audio-time">
                            <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                        </div>
                        <button class="audio-btn" onclick="stopAudio()">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                </div>
                
                <div id="tafsirText" style="color: #aaa; margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 10px; display: none;">
                    <h3 style="color: var(--gold); margin-bottom: 10px;"><i class="fas fa-book-open"></i> التفسير</h3>
                    <div id="tafsirContent"></div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="toggleAudioPlayer()">
                        <i class="fas fa-music"></i> استمع للسورة
                    </button>
                    <button class="btn" onclick="toggleTafsir()" style="margin: 0 10px;">
                        <i class="fas fa-book-open"></i> التفسير
                    </button>
                    <button class="btn btn-secondary" onclick="copySurahText()">
                        <i class="fas fa-copy"></i> نسخ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- تفاصيل الحكم الشرعي -->
    <div id="fatawaDetailModal" class="fatawa-detail-modal">
        <div class="fatawa-detail-content glass-effect">
            <div class="fatawa-detail-header">
                <h2 id="fatawaDetailTitle" style="color: var(--gold);"></h2>
                <button class="btn btn-secondary" onclick="closeFatawaDetail()">
                    <i class="fas fa-times"></i> إغلاق
                </button>
            </div>
            
            <div id="fatawaDetailContent">
                <!-- سيتم تحميل تفاصيل الحكم هنا -->
            </div>
            
            <div id="fatawaDetailSource" class="fatawa-source">
                <!-- سيتم تحميل المصدر هنا -->
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="copyFatawaDetail()">
                    <i class="fas fa-copy"></i> نسخ الحكم
                </button>
                <button class="btn btn-secondary" onclick="shareFatawaDetail()" style="margin-right: 10px;">
                    <i class="fas fa-share"></i> مشاركة
                </button>
            </div>
        </div>
    </div>
    
    <!-- تطبيق رعد -->
    <div class="container" id="mainApp" style="display: none;">
        <h1><i class="fas fa-mosque"></i> رعد</h1>
        <div class="subtitle">تطبيق إسلامي متكامل</div>
        
        <!-- التنقل الرئيسي -->
        <nav>
            <button onclick="showSection('quran')" id="m-quran" class="active">
                <i class="fas fa-quran"></i>
                <span>القرآن</span>
            </button>
            <button onclick="showSection('azkar')" id="m-azkar">
                <i class="fas fa-pray"></i>
                <span>الأذكار</span>
            </button>
            <button onclick="showSection('tasbih')" id="m-tasbih">
                <i class="fas fa-hands-praying"></i>
                <span>المسبحة</span>
            </button>
            <button onclick="showSection('hadith')" id="m-hadith">
                <i class="fas fa-book-open"></i>
                <span>الأحاديث</span>
            </button>
            <button onclick="showSection('prayer')" id="m-prayer">
                <i class="fas fa-clock"></i>
                <span>الصلاة</span>
            </button>
            <button onclick="showSection('qibla')" id="m-qibla">
                <i class="fas fa-compass"></i>
                <span>القبلة</span>
            </button>
            <button onclick="showSection('asma')" id="m-asma">
                <i class="fas fa-star"></i>
                <span>أسماء الله</span>
            </button>
            <button onclick="showSection('radio')" id="m-radio">
                <i class="fas fa-radio"></i>
                <span>الإذاعة</span>
            </button>
            <button onclick="showSection('articles')" id="m-articles">
                <i class="fas fa-newspaper"></i>
                <span>مقالات</span>
            </button>
            <button onclick="showSection('fatawa')" id="m-fatawa">
                <i class="fas fa-search"></i>
                <span>بحث الأحكام</span>
            </button>
            <!-- زر السمات الجديد -->
            <button onclick="showSection('theme')" id="m-theme">
                <i class="fas fa-palette"></i>
                <span>السمات</span>
            </button>
            <button onclick="window.open('http://barqalhuda.netlify.app', '_blank')" id="m-barq">
                <i class="fas fa-lightbulb"></i>
                <span>بارق الهدى</span>
            </button>
        </nav>
        
        <!-- القرآن الكريم -->
        <section id="quran" class="section active-section">
            <div class="quran-section">
                <h2><i class="fas fa-quran"></i> القرآن الكريم</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">اقرأ وسمع القرآن الكريم</p>
                
                <!-- شريط البحث عن الآيات -->
                <div class="ayah-search-section">
                    <h3 style="color: var(--gold); margin-bottom: 15px;"><i class="fas fa-search"></i> بحث في آيات القرآن</h3>
                    <div class="search-box">
                        <input type="text" id="searchAyah" placeholder="اكتب نص الآية التي تبحث عنها..." onkeypress="if(event.key === 'Enter') searchAyah()">
                    </div>
                    <div style="text-align: center; margin-top: 10px;">
                        <button class="btn" onclick="searchAyah()">
                            <i class="fas fa-search"></i> بحث عن الآية
                        </button>
                        <button class="btn btn-secondary" onclick="clearAyahSearch()" style="margin-right: 10px;">
                            <i class="fas fa-times"></i> مسح البحث
                        </button>
                    </div>
                </div>
                
                <!-- نتائج بحث الآيات -->
                <div id="ayahSearchResults" class="ayah-search-results-container" style="display: none;">
                    <h3 style="color: var(--gold); margin-bottom: 15px;"><i class="fas fa-list"></i> نتائج البحث</h3>
                    <div id="ayahResultsList" class="ayah-search-results">
                        <!-- سيتم عرض نتائج البحث هنا -->
                    </div>
                </div>
                
                <!-- شريط البحث عن السور -->
                <div class="search-box">
                    <input type="text" id="searchSurah" placeholder="ابحث عن سورة..." onkeyup="searchSurahs()">
                </div>
                
                <!-- أزرار التصفية -->
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterSurahs('all')">الكل</button>
                    <button class="filter-btn" onclick="filterSurahs('makkah')">مكية</button>
                    <button class="filter-btn" onclick="filterSurahs('madani')">مدنية</button>
                    <button class="filter-btn" onclick="filterSurahs('short')">قصيرة</button>
                    <button class="filter-btn" onclick="filterSurahs('long')">طويلة</button>
                </div>
                
                <!-- قائمة السور -->
                <div class="surahs-grid" id="surahsList">
                    <!-- سيتم تحميل السور هنا -->
                </div>
            </div>
        </section>
        
        <!-- الأذكار -->
        <section id="azkar" class="section">
            <div class="azkar-section">
                <h2><i class="fas fa-pray"></i> الأذكار</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">أذكار الصباح والمساء</p>
                
                <div class="azkar-tabs">
                    <button class="azkar-tab active" onclick="showAzkarTab('morning')">
                        <i class="fas fa-sun"></i> أذكار الصباح
                    </button>
                    <button class="azkar-tab" onclick="showAzkarTab('evening')">
                        <i class="fas fa-moon"></i> أذكار المساء
                    </button>
                    <button class="azkar-tab" onclick="showAzkarTab('sleep')">
                        <i class="fas fa-bed"></i> أذكار النوم
                    </button>
                    <button class="azkar-tab" onclick="showAzkarTab('prayer')">
                        <i class="fas fa-mosque"></i> أذكار الصلاة
                    </button>
                    <button class="azkar-tab" onclick="showAzkarTab('general')">
                        <i class="fas fa-star"></i> أذكار عامة
                    </button>
                </div>
                
                <div id="morningAzkar" class="azkar-content">
                    <!-- سيتم تحميل الأذكار هنا -->
                </div>
                
                <div id="eveningAzkar" class="azkar-content" style="display: none;">
                    <!-- سيتم تحميل الأذكار هنا -->
                </div>
                
                <div id="sleepAzkar" class="azkar-content" style="display: none;">
                    <!-- سيتم تحميل الأذكار هنا -->
                </div>
                
                <div id="prayerAzkar" class="azkar-content" style="display: none;">
                    <!-- سيتم تحميل الأذكار هنا -->
                </div>
                
                <div id="generalAzkar" class="azkar-content" style="display: none;">
                    <!-- سيتم تحميل الأذكار هنا -->
                </div>
            </div>
        </section>
        
        <!-- المسبحة -->
        <section id="tasbih" class="section">
            <div class="tasbih-section">
                <h2><i class="fas fa-hands-praying"></i> المسبحة الرقمية</h2>
                <p style="color: var(--light-text); margin-bottom: 30px;">سبح واهلل وكبر</p>
                
                <div class="counter-display" id="counter">0</div>
                
                <div id="currentTasbih" style="font-size: 1.5rem; color: var(--gold); margin-bottom: 20px;">سبحان الله</div>
                
                <div class="counter-buttons">
                    <button class="counter-btn" onclick="changeTasbih(-10)">
                        -10
                    </button>
                    <button class="counter-btn" onclick="changeTasbih(-1)">
                        -1
                    </button>
                    <button class="counter-btn" onclick="incrementTasbih()" style="background: var(--gold); color: black; width: 100px; height: 100px; font-size: 2.5rem;">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="counter-btn" onclick="changeTasbih(1)">
                        +1
                    </button>
                    <button class="counter-btn" onclick="changeTasbih(10)">
                        +10
                    </button>
                </div>
                
                <div style="margin: 30px 0; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn" onclick="resetTasbih()">
                        <i class="fas fa-redo"></i> إعادة تعيين
                    </button>
                    <button class="btn btn-secondary" onclick="setTasbihType('subhanallah')">
                        سبحان الله
                    </button>
                    <button class="btn btn-secondary" onclick="setTasbihType('alhamdulillah')">
                        الحمد لله
                    </button>
                    <button class="btn btn-secondary" onclick="setTasbihType('allahuakbar')">
                        الله أكبر
                    </button>
                </div>
                
                <div class="card glass-effect" style="margin-top: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--gold);"><i class="fas fa-chart-bar"></i> إحصائيات اليوم</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--gold);" id="todaySubhan">0</div>
                            <div style="color: #aaa; font-size: 0.9rem;">سبحان الله</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--gold);" id="todayHamd">0</div>
                            <div style="color: #aaa; font-size: 0.9rem;">الحمد لله</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--gold);" id="todayTakbir">0</div>
                            <div style="color: #aaa; font-size: 0.9rem;">الله أكبر</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- الأحاديث -->
        <section id="hadith" class="section">
            <div style="padding: 20px;">
                <h2><i class="fas fa-book-open"></i> الأحاديث النبوية</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">أحاديث صحيحة من السنة النبوية</p>
                
                <!-- تبادل مصادر الأحاديث -->
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="setHadithSource('muslim')">
                        <i class="fas fa-book"></i> صحيح مسلم
                    </button>
                    <button class="btn btn-secondary" onclick="setHadithSource('bukhari')">
                        <i class="fas fa-book"></i> صحيح البخاري
                    </button>
                    <button class="btn btn-secondary" onclick="setHadithSource('mixed')">
                        <i class="fas fa-random"></i> مختلط
                    </button>
                </div>
                
                <div class="card glass-effect hadith-card">
                    <div class="hadith-text" id="currentHadithText">
                        <!-- سيتم تحميل الحديث هنا -->
                    </div>
                    <div class="hadith-reference" id="currentHadithRef">
                        <!-- سيتم تحميل المرجع هنا -->
                    </div>
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <button class="btn" onclick="copyHadith()" style="flex: 1;">
                            <i class="fas fa-copy"></i> نسخ
                        </button>
                        <button class="btn btn-secondary" onclick="shareHadith()" style="flex: 1;">
                            <i class="fas fa-share"></i> مشاركة
                        </button>
                        <button class="btn btn-secondary" onclick="loadRandomHadith()" style="flex: 1;">
                            <i class="fas fa-forward"></i> حديث جديد
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- الصلاة -->
        <section id="prayer" class="section">
            <div style="padding: 20px;">
                <h2><i class="fas fa-clock"></i> أوقات الصلاة</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">مواقيت الصلاة حسب موقعك</p>
                
                <div class="card glass-effect">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 2rem; color: var(--gold); margin-bottom: 10px;" id="currentTime">--:--</div>
                        <div style="color: #aaa;" id="currentDate">...</div>
                        <div style="color: var(--gold); margin-top: 10px;" id="hijriDate"></div>
                    </div>
                    
                    <!-- خيارات المذهب -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: var(--gold); margin-bottom: 10px;"><i class="fas fa-mosque"></i> المذهب الحسابي</h3>
                        <div class="prayer-options">
                            <div class="prayer-method-card active" onclick="setPrayerMethod('2')">
                                <div class="prayer-method-icon">
                                    <i class="fas fa-kaaba"></i>
                                </div>
                                <div style="font-weight: bold;">أم القرى</div>
                                <div style="color: #aaa; font-size: 0.9rem;">السعودية</div>
                            </div>
                            <div class="prayer-method-card" onclick="setPrayerMethod('5')">
                                <div class="prayer-method-icon">
                                    <i class="fas fa-monument"></i>
                                </div>
                                <div style="font-weight: bold;">المصرية</div>
                                <div style="color: #aaa; font-size: 0.9rem;">مصر</div>
                            </div>
                            <div class="prayer-method-card" onclick="setPrayerMethod('1')">
                                <div class="prayer-method-icon">
                                    <i class="fas fa-mosque"></i>
                                </div>
                                <div style="font-weight: bold;">جامعة الإسلامية</div>
                                <div style="color: #aaa; font-size: 0.9rem;">كراتشي</div>
                            </div>
                            <div class="prayer-method-card" onclick="setPrayerMethod('3')">
                                <div class="prayer-method-icon">
                                    <i class="fas fa-globe-americas"></i>
                                </div>
                                <div style="font-weight: bold;">شمال أمريكا</div>
                                <div style="color: #aaa; font-size: 0.9rem;">أمريكا/كندا</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- مدخلات الموقع -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: var(--gold); margin-bottom: 10px;"><i class="fas fa-location-dot"></i> الموقع</h3>
                        <div class="location-inputs">
                            <input type="text" id="cityInput" placeholder="المدينة" value="مكة">
                            <input type="text" id="countryInput" placeholder="البلد" value="السعودية">
                        </div>
                        <div style="text-align: center; margin-top: 10px;">
                            <button class="btn" onclick="getPrayerTimes()">
                                <i class="fas fa-search"></i> احسب الأوقات
                            </button>
                            <button class="btn btn-secondary" onclick="getUserLocation()" style="margin-right: 10px;">
                                <i class="fas fa-location-crosshairs"></i> موقعي الحالي
                            </button>
                        </div>
                    </div>
                    
                    <!-- عرض أوقات الصلاة -->
                    <div class="prayer-times" id="prayerTimes">
                        <!-- سيتم تحديث أوقات الصلاة هنا -->
                    </div>
                </div>
                
                <!-- الصلاة القادمة -->
                <div class="card glass-effect" style="margin-top: 20px;">
                    <h3 style="color: var(--gold); margin-bottom: 15px;"><i class="fas fa-clock"></i> الصلاة القادمة</h3>
                    <div style="text-align: center; padding: 15px;">
                        <div style="font-size: 1.8rem; color: var(--gold); margin-bottom: 10px;" id="nextPrayerName">المغرب</div>
                        <div style="font-size: 2.5rem; color: var(--gold); margin-bottom: 10px;" id="nextPrayerTime">18:20</div>
                        <div style="color: #aaa; margin: 10px 0;">تبقى: <span id="timeRemaining">01:30:15</span></div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- القبلة -->
        <section id="qibla" class="section">
            <div class="qibla-section">
                <h2><i class="fas fa-compass"></i> اتجاه القبلة</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">ابحث عن اتجاه القبلة من موقعك</p>
                
                <div class="card glass-effect">
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: var(--gold); margin-bottom: 10px;"><i class="fas fa-location-dot"></i> الموقع</h3>
                        <div style="text-align: center;">
                            <button class="btn" onclick="getCurrentLocationForQibla()">
                                <i class="fas fa-location-crosshairs"></i> احسب اتجاه القبلة من موقعي الحالي
                            </button>
                        </div>
                    </div>
                    
                    <!-- البوصلة -->
                    <div class="qibla-compass">
                        <div class="compass-circle glass-effect">
                            <div class="compass-needle" id="compassNeedle">
                                <div class="needle"></div>
                            </div>
                            <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 1.2rem; color: var(--gold);">N</div>
                            <div style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 1.2rem; color: var(--gold);">S</div>
                            <div style="position: absolute; top: 50%; left: 20px; transform: translateY(-50%); font-size: 1.2rem; color: var(--gold);">W</div>
                            <div style="position: absolute; top: 50%; right: 20px; transform: translateY(-50%); font-size: 1.2rem; color: var(--gold);">E</div>
                        </div>
                    </div>
                    
                    <!-- اتجاه القبلة -->
                    <div class="qibla-direction" id="qiblaDirection">
                        0°
                    </div>
                    <div style="color: var(--light-text); margin-bottom: 20px;" id="qiblaLocation">
                        اتجاه القبلة من موقعك
                    </div>
                    
                    <!-- معلومات إضافية -->
                    <div style="color: #aaa; font-size: 0.9rem; text-align: center;">
                        <div>إلى الكعبة المشرفة في مكة المكرمة</div>
                        <div>إحداثيات الكعبة: 21.4225° N, 39.8262° E</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- أسماء الله الحسنى -->
        <section id="asma" class="section">
            <div class="asma-section">
                <h2><i class="fas fa-star"></i> أسماء الله الحسنى</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">تعرف على أسماء الله الحسنى وصفاته</p>
                
                <!-- شريط البحث -->
                <div class="search-box">
                    <input type="text" id="searchAsma" placeholder="ابحث عن اسم من أسماء الله..." onkeyup="searchAsma()">
                </div>
                
                <!-- أزرار التحكم -->
                <div style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;">
                    <button class="btn" onclick="showRandomName()">
                        <i class="fas fa-random"></i> اسم عشوائي
                    </button>
                    <button class="btn btn-secondary" onclick="showAllNames()">
                        <i class="fas fa-list"></i> عرض الكل
                    </button>
                </div>
                
                <!-- قائمة أسماء الله الحسنى -->
                <div class="asma-grid" id="asmaList">
                    <!-- سيتم تحميل الأسماء هنا -->
                </div>
            </div>
        </section>
        
        <!-- إذاعة القرآن الكريم -->
        <section id="radio" class="section">
            <div class="radio-section">
                <h2><i class="fas fa-radio"></i> إذاعة القرآن الكريم</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">استمع إلى إذاعات القرآن الكريم من مختلف الدول</p>
                
                <!-- محطات الإذاعة -->
                <div class="radio-stations" id="radioStations">
                    <!-- سيتم تحميل المحطات هنا -->
                </div>
                
                <!-- مشغل الإذاعة -->
                <div id="radioPlayer" class="audio-player" style="display: none;">
                    <div style="color: var(--gold); margin-bottom: 10px; text-align: center;">
                        <i class="fas fa-radio"></i> الإذاعة النشطة
                    </div>
                    <div id="currentRadioInfo" style="text-align: center; margin-bottom: 15px;">
                        <h4 id="currentRadioName">اسم المحطة</h4>
                        <p id="currentRadioCountry">البلد</p>
                    </div>
                    <div class="audio-controls">
                        <button class="audio-btn" onclick="playPauseRadio()" id="radioPlayBtn">
                            <i class="fas fa-play"></i>
                        </button>
                        <div class="audio-progress" onclick="seekRadio(event)">
                            <div class="audio-progress-fill" id="radioProgress"></div>
                        </div>
                        <div class="audio-time">
                            <span id="radioCurrentTime">0:00</span> / <span id="radioDuration">0:00</span>
                        </div>
                        <button class="audio-btn" onclick="stopRadio()">
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- المقالات الإسلامية -->
        <section id="articles" class="section">
            <div class="articles-section">
                <h2><i class="fas fa-newspaper"></i> المقالات الإسلامية</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">مقالات ودروس إسلامية متنوعة</p>
                
                <!-- شريط البحث -->
                <div class="search-box">
                    <input type="text" id="searchArticles" placeholder="ابحث عن مقالات..." onkeyup="searchArticles()">
                </div>
                
                <!-- فئات المقالات -->
                <div class="filter-buttons" id="articleCategories">
                    <button class="filter-btn active" onclick="filterArticles('all')">الكل</button>
                </div>
                
                <!-- قائمة المقالات -->
                <div class="articles-grid" id="articlesList">
                    <!-- سيتم تحميل المقالات هنا -->
                </div>
            </div>
        </section>
        
        <!-- البحث عن الأحكام -->
        <section id="fatawa" class="section">
            <div class="fatawa-section">
                <h2><i class="fas fa-search"></i> الأحكام الشرعية</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">مجموعة من الأحكام الشرعية المصنفة حسب المواضيع</p>
                
                <div class="card glass-effect">
                    <h3 style="color: var(--gold); margin-bottom: 15px;"><i class="fas fa-filter"></i> تصفية الأحكام حسب الموضوع</h3>
                    
                    <div class="filter-buttons" id="fatawaCategories">
                        <button class="filter-btn active" onclick="filterFatawa('all')">الكل</button>
                        <!-- سيتم تحميل الفئات هنا -->
                    </div>
                    
                    <!-- شريط البحث في الأحكام -->
                    <div class="search-box" style="margin-top: 20px;">
                        <input type="text" id="searchFatawa" placeholder="ابحث في الأحكام الشرعية..." onkeyup="searchFatawa()">
                    </div>
                </div>
                
                <!-- قائمة الأحكام -->
                <div class="fatawa-grid" id="fatawaList">
                    <!-- سيتم تحميل الأحكام هنا -->
                </div>
                
                <div id="fatawaLoading" style="display: none; text-align: center; padding: 40px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--gold); margin-bottom: 15px;"></i>
                    <p style="color: #aaa;">جاري تحميل الأحكام الشرعية...</p>
                </div>
                
                <div id="noFatawaResults" class="no-results" style="display: none;">
                    <i class="fas fa-search" style="font-size: 3rem; color: #666; margin-bottom: 15px;"></i>
                    <p>لا توجد أحكام مطابقة للبحث</p>
                </div>
            </div>
        </section>
        
        <!-- السمات -->
        <section id="theme" class="section">
            <div style="padding: 20px;">
                <h2><i class="fas fa-palette"></i> تخصيص التطبيق</h2>
                <p style="color: var(--light-text); margin-bottom: 20px; text-align: center;">اختر السمة المفضلة لديك</p>
                
                <div class="theme-selector">
                    <!-- الأساسية -->
                    <div class="theme-card active" onclick="selectTheme('gold')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #0a0a0a, #161616); border: 2px solid #FFD700;">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div>الذهبية</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('green')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #0a140a, #162016); border: 2px solid #27ae60;">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div>الخضراء</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('blue')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #0a0a14, #161620); border: 2px solid #3498db;">
                            <i class="fas fa-cloud"></i>
                        </div>
                        <div>الزرقاء (السماء)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('purple')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #140a14, #201620); border: 2px solid #9b59b6;">
                            <i class="fas fa-gem"></i>
                        </div>
                        <div>الأرجوانية (الملكي)</div>
                    </div>
                    
                    <!-- الجديدة -->
                    <div class="theme-card" onclick="selectTheme('brown')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #1a120a, #2c241a); border: 2px solid #8B4513;">
                            <i class="fas fa-mountain"></i>
                        </div>
                        <div>البني (الأرض)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('pink')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #140a0f, #2c1a24); border: 2px solid #e91e63;">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div>الوردي (الرقة)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('red')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #140a0a, #2c1a1a); border: 2px solid #e74c3c;">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div>الأحمر (القوة)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('yellow')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #14140a, #2c2c1a); border: 2px solid #f1c40f;">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div>الأصفر (الشمس)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('orange')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #140f0a, #2c241a); border: 2px solid #e67e22;">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div>البرتقالي (الطاقة)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('white')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #f8f9fa, #ffffff); border: 2px solid #2c3e50;">
                            <i class="fas fa-book-reader"></i>
                        </div>
                        <div>الأبيض (النهاري)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('gray')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #2c3e50, #34495e); border: 2px solid #7f8c8d;">
                            <i class="fas fa-mountain"></i>
                        </div>
                        <div>الرمادي (الجبال)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('cherry')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #1a0f14, #2c1a24); border: 2px solid #e84393;">
                            <i class="fas fa-cherries"></i>
                        </div>
                        <div>العنابي (الكرز)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('wine')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #0f0a0f, #1a141a); border: 2px solid #6d214f;">
                            <i class="fas fa-wine-glass-alt"></i>
                        </div>
                        <div>الخمري (العميق)</div>
                    </div>
                    
                    <div class="theme-card" onclick="selectTheme('icy')">
                        <div class="theme-preview" style="background: linear-gradient(135deg, #0a141f, #1a2c3c); border: 2px solid #74b9ff;">
                            <i class="fas fa-snowflake"></i>
                        </div>
                        <div>الجليدي (الجليد)</div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="resetTheme()">
                        <i class="fas fa-undo"></i> إعادة التعيين
                    </button>
                </div>
            </div>
        </section>
        
        <!-- الفوتر -->
        <div class="footer-nav">
            <button class="footer-btn active" onclick="showSection('quran')">
                <i class="fas fa-quran"></i>
                <span>قرآن</span>
            </button>
            <button class="footer-btn" onclick="showSection('azkar')">
                <i class="fas fa-pray"></i>
                <span>أذكار</span>
            </button>
            <button class="footer-btn" onclick="showSection('tasbih')">
                <i class="fas fa-hands-praying"></i>
                <span>مسبحة</span>
            </button>
            <button class="footer-btn" onclick="showSection('fatawa')">
                <i class="fas fa-search"></i>
                <span>أحكام</span>
            </button>
            <button class="footer-btn" onclick="showSection('theme')">
                <i class="fas fa-palette"></i>
                <span>سمات</span>
            </button>
            <button class="footer-btn" onclick="window.open('http://barqalhuda.netlify.app', '_blank')">
                <i class="fas fa-lightbulb"></i>
                <span>بارق الهدى</span>
            </button>
        </div>
    </div>

    <script>
        // ==================== المتغيرات العامة ====================
        let allSurahs = [];
        let currentSurah = null;
        let hadiths = {
            muslim: [],
            bukhari: [],
            mixed: []
        };
        let currentHadithSource = 'mixed';
        let allAsma = [];
        let qiblaDirection = 0;
        let audioPlayer = null;
        let currentReciter = '1'; // ID القارئ
        let isPlaying = false;
        let currentLocation = null;
        let radioPlayer = null;
        let currentRadioStation = null;
        let isRadioPlaying = false;
        let islamicArticles = [];
        let articleCategories = new Set();
        let allFatawa = [];
        let fatawaCategories = new Set();
        let ayahSearchCache = new Map();
        
        // إحصائيات المسبحة
        let tasbihStats = {
            subhan: 0,
            hamd: 0,
            takbir: 0
        };
        
        // إعدادات الصلاة
        let prayerSettings = {
            method: '2',
            city: 'مكة',
            country: 'السعودية'
        };
        
        // أوقات الصلاة الحالية
        let currentPrayerTimes = {};
        let nextPrayerTimer = null;
        
        // ==================== نظام الأصوات التفاعلية ====================
        const audioSystem = {
            enabled: true,
            volume: 0.3,
            
            init() {
                this.enabled = typeof Audio !== 'undefined';
            },
            
            playSound(type) {
                if (!this.enabled) return;
                
                try {
                    if (window.AudioContext || window.webkitAudioContext) {
                        const AudioContext = window.AudioContext || window.webkitAudioContext;
                        const audioCtx = new AudioContext();
                        const oscillator = audioCtx.createOscillator();
                        const gainNode = audioCtx.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioCtx.destination);
                        
                        switch(type) {
                            case 'click':
                                oscillator.frequency.value = 800;
                                oscillator.type = 'sine';
                                gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
                                gainNode.gain.linearRampToValueAtTime(this.volume, audioCtx.currentTime + 0.01);
                                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.1);
                                oscillator.start(audioCtx.currentTime);
                                oscillator.stop(audioCtx.currentTime + 0.1);
                                break;
                                
                            case 'notification':
                                oscillator.frequency.value = 1200;
                                oscillator.type = 'sine';
                                gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
                                gainNode.gain.linearRampToValueAtTime(this.volume, audioCtx.currentTime + 0.05);
                                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
                                oscillator.start(audioCtx.currentTime);
                                oscillator.stop(audioCtx.currentTime + 0.3);
                                break;
                                
                            case 'section':
                                oscillator.frequency.value = 600;
                                oscillator.type = 'sine';
                                gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
                                gainNode.gain.linearRampToValueAtTime(this.volume * 0.5, audioCtx.currentTime + 0.1);
                                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.4);
                                oscillator.start(audioCtx.currentTime);
                                oscillator.stop(audioCtx.currentTime + 0.4);
                                break;
                        }
                    }
                } catch (e) {
                    console.log('نظام الصوت غير متوفر');
                }
            }
        };
        
        // ==================== تهيئة التطبيق مع شاشة التحميل ====================
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // تهيئة شاشة التحميل مع الثيم المختار
                initLoadingScreen();
                
                // إخفاء شاشة التحميل بعد 2 ثانية
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('loadingScreen').style.display = 'none';
                        document.getElementById('mainApp').style.display = 'block';
                        
                        // تهيئة الأنظمة
                        audioSystem.init();
                        updateDateTime();
                        setInterval(updateDateTime, 1000);
                        loadSettings();
                        applyGlassEffect();
                        
                        showNotification('مرحباً بك', 'في تطبيق رعد الإسلامي المتكامل');
                        audioSystem.playSound('notification');
                    }, 300);
                }, 2000);
                
                // تحميل البيانات من APIs بشكل غير متزامن
                await Promise.all([
                    fetchSurahs(),
                    loadAzkar(),
                    loadHadiths(),
                    loadAsma(),
                    getPrayerTimes(),
                    loadRadioStations(),
                    loadIslamicArticles(),
                    loadFatawaFromCSV()
                ]);
                
                console.log('✅ جميع البيانات تم تحميلها بنجاح');
                
            } catch (error) {
                console.error('خطأ في تحميل البيانات:', error);
                showNotification('تنبيه', 'تم تحميل البيانات الأساسية، بعض الميزات قد لا تعمل');
            }
            
            // إضافة أصوات للأزرار
            document.addEventListener('click', function(e) {
                if (audioSystem.enabled && e.target.matches('button, .btn, .counter-btn, .count-btn, .filter-btn, .azkar-tab, .surah-card, .theme-card, .prayer-method-card, .radio-card')) {
                    setTimeout(() => audioSystem.playSound('click'), 10);
                }
            });
        });
        
        // ==================== تهيئة شاشة التحميل مع الثيم ====================
        function initLoadingScreen() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingIcon = document.querySelector('.loading-icon');
            const loadingTitle = document.querySelector('.loading-title');
            const loadingText = document.querySelector('.loading-text');
            
            if (loadingScreen) {
                loadingScreen.style.background = getComputedStyle(document.body).getPropertyValue('--bg');
            }
            
            if (loadingIcon) {
                loadingIcon.style.color = getComputedStyle(document.body).getPropertyValue('--gold');
            }
            
            if (loadingTitle) {
                loadingTitle.style.color = getComputedStyle(document.body).getPropertyValue('--gold');
            }
            
            if (loadingText) {
                loadingText.style.color = getComputedStyle(document.body).getPropertyValue('--light-text');
            }
        }
        
        // ==================== نظام القرآن الكريم ====================
        async function fetchSurahs() {
            try {
                showLoadingSurahs();
                
                const response = await fetch('https://api.quran.com/api/v4/chapters');
                const data = await response.json();
                
                if (data && data.chapters) {
                    allSurahs = data.chapters;
                    displaySurahs(allSurahs);
                    showNotification('تم', `تم تحميل ${allSurahs.length} سورة`);
                } else {
                    loadDefaultSurahs();
                }
                
            } catch (error) {
                console.error('Error fetching surahs:', error);
                showNotification('تنبيه', 'تم تحميل السور من مصدر محلي');
                loadDefaultSurahs();
            }
        }
        
        function loadDefaultSurahs() {
            // بيانات سور افتراضية في حال فشل API
            allSurahs = [
                { id: 1, name_arabic: 'الفاتحة', translated_name: { name: 'الفاتحة' }, verses_count: 7, revelation_place: 'makkah' },
                { id: 2, name_arabic: 'البقرة', translated_name: { name: 'البقرة' }, verses_count: 286, revelation_place: 'madinah' },
                { id: 3, name_arabic: 'آل عمران', translated_name: { name: 'آل عمران' }, verses_count: 200, revelation_place: 'madinah' },
                { id: 4, name_arabic: 'النساء', translated_name: { name: 'النساء' }, verses_count: 176, revelation_place: 'madinah' },
                { id: 5, name_arabic: 'المائدة', translated_name: { name: 'المائدة' }, verses_count: 120, revelation_place: 'madinah' },
                { id: 6, name_arabic: 'الأنعام', translated_name: { name: 'الأنعام' }, verses_count: 165, revelation_place: 'makkah' },
                { id: 7, name_arabic: 'الأعراف', translated_name: { name: 'الأعراف' }, verses_count: 206, revelation_place: 'makkah' },
                { id: 8, name_arabic: 'الأنفال', translated_name: { name: 'الأنفال' }, verses_count: 75, revelation_place: 'madinah' },
                { id: 9, name_arabic: 'التوبة', translated_name: { name: 'التوبة' }, verses_count: 129, revelation_place: 'madinah' },
                { id: 10, name_arabic: 'يونس', translated_name: { name: 'يونس' }, verses_count: 109, revelation_place: 'makkah' }
            ];
            displaySurahs(allSurahs);
        }
        
        function displaySurahs(surahs) {
            const surahsList = document.getElementById('surahsList');
            if (!surahsList) return;
            
            surahsList.innerHTML = '';
            
            surahs.forEach(surah => {
                const surahCard = document.createElement('div');
                surahCard.className = 'surah-card glass-effect';
                surahCard.onclick = () => openSurah(surah.id);
                
                surahCard.innerHTML = `
                    <div class="surah-number">${surah.id}</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">${surah.name_arabic}</div>
                    <div style="color: #aaa; font-size: 0.9rem;">${surah.translated_name?.name || '...'} | ${surah.verses_count} آيات</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">${surah.revelation_place === 'makkah' ? 'مكية' : 'مدنية'}</div>
                `;
                
                surahsList.appendChild(surahCard);
            });
        }
        
        function showLoadingSurahs() {
            const surahsList = document.getElementById('surahsList');
            if (surahsList) {
                surahsList.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 10px; color: var(--gold);"></i>
                        <p style="color: #aaa;">جاري تحميل السور...</p>
                    </div>
                `;
            }
        }
        
        async function openSurah(surahId) {
            try {
                showNotification('جاري التحميل', 'جاري تحميل السورة...');
                audioSystem.playSound('section');
                
                // جلب معلومات السورة
                const surahResponse = await fetch(`https://api.quran.com/api/v4/chapters/${surahId}`);
                const surahData = await surahResponse.json();
                
                // جلب آيات السورة
                const versesResponse = await fetch(`https://api.quran.com/api/v4/quran/verses/uthmani?chapter_number=${surahId}`);
                const versesData = await versesResponse.json();
                
                currentSurah = {
                    info: surahData.chapter,
                    verses: versesData.verses
                };
                
                displaySurahDetails();
                audioSystem.playSound('notification');
                
            } catch (error) {
                console.error('Error fetching surah:', error);
                showNotification('خطأ', 'تعذر تحميل السورة. حاول مرة أخرى');
            }
        }
        
        function displaySurahDetails() {
            if (!currentSurah) return;
            
            const surah = currentSurah.info;
            const verses = currentSurah.verses;
            
            document.getElementById('surahTitle').textContent = `سورة ${surah.name_arabic}`;
            
            document.getElementById('surahInfo').innerHTML = `
                ${surah.revelation_place === 'makkah' ? 'مكية' : 'مدنية'} | 
                ${surah.verses_count} آية
            `;
            
            let versesHTML = '';
            verses.forEach(verse => {
                versesHTML += `
                    <div style="margin-bottom: 20px;">
                        <span class="ayah-number">(${verse.verse_key})</span>
                        <span>${verse.text_uthmani}</span>
                    </div>
                `;
            });
            
            document.getElementById('surahText').innerHTML = versesHTML;
            document.getElementById('surahDetails').style.display = 'block';
        }
        
        // ==================== نظام القرآن الصوتي المعدل ====================
        async function toggleAudioPlayer() {
            const player = document.getElementById('audioPlayer');
            if (player.style.display === 'none') {
                player.style.display = 'block';
                await loadAudioForSurah();
            } else {
                player.style.display = 'none';
                stopAudio();
            }
            audioSystem.playSound('click');
        }
        
        async function loadAudioForSurah() {
            if (!currentSurah) return;
            
            const surahId = currentSurah.info.id;
            
            try {
                // استخدام API الجديد للقرآن الصوتي
                const response = await fetch(`https://api.quran.com/api/v4/chapter_recitations/${currentReciter}/${surahId}`);
                const data = await response.json();
                
                if (data && data.audio_file) {
                    const audioUrl = data.audio_file.audio_url;
                    
                    if (audioPlayer) {
                        stopAudio();
                    }
                    
                    audioPlayer = new Audio(audioUrl);
                    audioPlayer.preload = 'metadata';
                    
                    audioPlayer.addEventListener('loadedmetadata', function() {
                        document.getElementById('duration').textContent = formatTime(audioPlayer.duration);
                    });
                    
                    audioPlayer.addEventListener('timeupdate', function() {
                        if (audioPlayer.duration) {
                            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                            document.getElementById('audioProgress').style.width = progress + '%';
                            document.getElementById('currentTime').textContent = formatTime(audioPlayer.currentTime);
                        }
                    });
                    
                    audioPlayer.addEventListener('ended', function() {
                        isPlaying = false;
                        document.getElementById('playPauseBtn').innerHTML = '<i class="fas fa-play"></i>';
                    });
                    
                    showNotification('تم', 'جاهز للتشغيل');
                    
                } else {
                    showNotification('خطأ', 'تعذر تحميل التلاوة من هذا القارئ');
                }
                
            } catch (error) {
                console.error('Error loading audio:', error);
                showNotification('خطأ', 'تعذر تحميل التلاوة');
            }
        }
        
        function playPauseAudio() {
            if (!audioPlayer) return;
            
            if (isPlaying) {
                audioPlayer.pause();
                document.getElementById('playPauseBtn').innerHTML = '<i class="fas fa-play"></i>';
            } else {
                audioPlayer.play();
                document.getElementById('playPauseBtn').innerHTML = '<i class="fas fa-pause"></i>';
            }
            isPlaying = !isPlaying;
            audioSystem.playSound('click');
        }
        
        function stopAudio() {
            if (!audioPlayer) return;
            
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            isPlaying = false;
            document.getElementById('playPauseBtn').innerHTML = '<i class="fas fa-play"></i>';
            document.getElementById('audioProgress').style.width = '0%';
            document.getElementById('currentTime').textContent = '0:00';
        }
        
        function seekAudio(event) {
            if (!audioPlayer) return;
            
            const progressBar = event.currentTarget;
            const clickPosition = event.offsetX;
            const totalWidth = progressBar.clientWidth;
            const percentage = (clickPosition / totalWidth) * 100;
            
            if (audioPlayer.duration) {
                audioPlayer.currentTime = (percentage / 100) * audioPlayer.duration;
                audioSystem.playSound('click');
            }
        }
        
        function changeReciter() {
            const reciterSelect = document.getElementById('reciterSelect');
            if (reciterSelect) {
                currentReciter = reciterSelect.value;
                
                if (currentSurah) {
                    loadAudioForSurah();
                }
                audioSystem.playSound('click');
            }
        }
        
        async function toggleTafsir() {
            const tafsirElement = document.getElementById('tafsirText');
            tafsirElement.style.display = tafsirElement.style.display === 'none' ? 'block' : 'none';
            
            if (tafsirElement.style.display === 'block' && !document.getElementById('tafsirContent').innerHTML) {
                await loadTafsir();
            }
            audioSystem.playSound('click');
        }
        
        async function loadTafsir() {
            if (!currentSurah) return;
            
            try {
                const surahId = currentSurah.info.id;
                // استخدام API التفسير الجديد
                const response = await fetch(`https://quranenc.com/api/v1/translation/sura/arabic_moyassar/${surahId}`);
                const data = await response.json();
                
                if (data && data.result) {
                    let tafsirHTML = '';
                    data.result.forEach(verse => {
                        tafsirHTML += `
                            <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,215,0,0.1);">
                                <div style="color: var(--gold); margin-bottom: 5px;">آية ${verse.aya}</div>
                                <div style="color: #aaa;">${verse.translation}</div>
                            </div>
                        `;
                    });
                    
                    document.getElementById('tafsirContent').innerHTML = tafsirHTML;
                } else {
                    document.getElementById('tafsirContent').innerHTML = 'لم يتم العثور على تفسير لهذه السورة.';
                }
            } catch (error) {
                console.error('Error loading tafsir:', error);
                document.getElementById('tafsirContent').innerHTML = 'تعذر تحميل التفسير. حاول مرة أخرى.';
            }
        }
        
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function closeSurahDetails() {
            document.getElementById('surahDetails').style.display = 'none';
            if (audioPlayer) {
                stopAudio();
            }
            currentSurah = null;
            audioSystem.playSound('click');
        }
        
        function searchSurahs() {
            const searchInput = document.getElementById('searchSurah');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            
            if (!searchTerm) {
                displaySurahs(allSurahs);
                return;
            }
            
            const filtered = allSurahs.filter(surah => 
                surah.name_arabic.includes(searchTerm) || 
                (surah.translated_name?.name && surah.translated_name.name.toLowerCase().includes(searchTerm))
            );
            
            displaySurahs(filtered);
        }
        
        function filterSurahs(filterType) {
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                if (btn.textContent.includes(filterType) || btn.textContent === 'الكل') {
                    btn.classList.remove('active');
                }
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            let filtered = allSurahs;
            
            switch(filterType) {
                case 'makkah':
                    filtered = allSurahs.filter(s => s.revelation_place === 'makkah');
                    break;
                case 'madani':
                    filtered = allSurahs.filter(s => s.revelation_place === 'madinah');
                    break;
                case 'short':
                    filtered = allSurahs.filter(s => s.verses_count < 50);
                    break;
                case 'long':
                    filtered = allSurahs.filter(s => s.verses_count > 100);
                    break;
            }
            
            displaySurahs(filtered);
            audioSystem.playSound('click');
        }
        
        function copySurahText() {
            if (!currentSurah) return;
            
            let textToCopy = `سورة ${currentSurah.info.name_arabic}\n\n`;
            currentSurah.verses.forEach(verse => {
                textToCopy += `${verse.text_uthmani} (${verse.verse_key})\n`;
            });
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        showNotification('تم النسخ', 'تم نسخ نص السورة');
                        audioSystem.playSound('notification');
                    })
                    .catch(() => showNotification('خطأ', 'تعذر نسخ النص'));
            } else {
                // طريقة بديلة للهواتف القديمة
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('تم النسخ', 'تم نسخ نص السورة');
                audioSystem.playSound('notification');
            }
        }
        
        // ==================== البحث عن الآيات في القرآن ====================
        async function searchAyah() {
            const searchInput = document.getElementById('searchAyah');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.trim();
            if (!searchTerm || searchTerm.length < 2) {
                showNotification('تنبيه', 'الرجاء إدخال نص للبحث (حرفين على الأقل)');
                return;
            }
            
            // إظهار نتائج البحث
            const resultsContainer = document.getElementById('ayahSearchResults');
            const resultsList = document.getElementById('ayahResultsList');
            
            resultsContainer.style.display = 'block';
            resultsList.innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--gold); margin-bottom: 15px;"></i>
                    <p style="color: #aaa;">جاري البحث عن الآيات...</p>
                </div>
            `;
            
            try {
                // التحقق من وجود النتائج في الذاكرة المؤقتة
                const cacheKey = searchTerm.toLowerCase();
                if (ayahSearchCache.has(cacheKey)) {
                    const cachedResults = ayahSearchCache.get(cacheKey);
                    displayAyahResults(cachedResults);
                    return;
                }
                
                // البحث في القرآن الكريم
                const response = await fetch(`https://api.quran.com/api/v4/search?q=${encodeURIComponent(searchTerm)}&language=ar&size=20`);
                const data = await response.json();
                
                if (data && data.search && data.search.results) {
                    const searchResults = data.search.results;
                    
                    // تخزين النتائج في الذاكرة المؤقتة
                    ayahSearchCache.set(cacheKey, searchResults);
                    
                    // عرض النتائج
                    displayAyahResults(searchResults);
                    
                    if (searchResults.length === 0) {
                        showNotification('تنبيه', 'لم يتم العثور على آيات تطابق البحث');
                    } else {
                        showNotification('تم', `تم العثور على ${searchResults.length} نتيجة`);
                    }
                } else {
                    displayAyahResults([]);
                    showNotification('تنبيه', 'لم يتم العثور على نتائج');
                }
            } catch (error) {
                console.error('Error searching ayah:', error);
                resultsList.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #e74c3c; margin-bottom: 15px;"></i>
                        <p>تعذر إجراء البحث. تحقق من اتصالك بالإنترنت وحاول مرة أخرى.</p>
                    </div>
                `;
                showNotification('خطأ', 'تعذر إجراء البحث');
            }
        }
        
        async function displayAyahResults(results) {
            const resultsList = document.getElementById('ayahResultsList');
            
            if (!results || results.length === 0) {
                resultsList.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search" style="font-size: 3rem; color: #666; margin-bottom: 15px;"></i>
                        <p>لم يتم العثور على آيات تطابق البحث</p>
                    </div>
                `;
                return;
            }
            
            resultsList.innerHTML = '';
            
            // جلب معلومات السور لجميع النتائج
            const surahIds = [...new Set(results.map(result => result.verse_key.split(':')[0]))];
            const surahsInfo = {};
            
            try {
                for (const surahId of surahIds) {
                    const surahResponse = await fetch(`https://api.quran.com/api/v4/chapters/${surahId}`);
                    const surahData = await surahResponse.json();
                    if (surahData && surahData.chapter) {
                        surahsInfo[surahId] = surahData.chapter;
                    }
                }
            } catch (error) {
                console.error('Error fetching surahs info:', error);
            }
            
            // عرض النتائج
            for (const result of results) {
                const [surahId, ayahNumber] = result.verse_key.split(':');
                const surahInfo = surahsInfo[surahId] || { name_arabic: `سورة ${surahId}`, verses_count: 0 };
                
                const ayahCard = document.createElement('div');
                ayahCard.className = 'ayah-result-card glass-effect';
                
                ayahCard.innerHTML = `
                    <div class="ayah-result-content">
                        ${result.text || result.highlighted || '...'}
                    </div>
                    <div class="ayah-result-info">
                        <div>
                            <i class="fas fa-book-open"></i>
                            <span>${surahInfo.name_arabic} - الآية ${ayahNumber}</span>
                        </div>
                        <div>
                            <i class="fas fa-hashtag"></i>
                            <span>ترتيب السورة: ${surahId}</span>
                        </div>
                    </div>
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <button class="btn" onclick="openSurah(${surahId})" style="flex: 1;">
                            <i class="fas fa-external-link-alt"></i> فتح السورة
                        </button>
                        <button class="btn btn-secondary" onclick="copyAyahText('${result.text.replace(/'/g, "\\'")}', '${surahInfo.name_arabic}', ${ayahNumber})" style="flex: 1;">
                            <i class="fas fa-copy"></i> نسخ الآية
                        </button>
                    </div>
                `;
                
                resultsList.appendChild(ayahCard);
            }
        }
        
        function clearAyahSearch() {
            document.getElementById('searchAyah').value = '';
            document.getElementById('ayahSearchResults').style.display = 'none';
            audioSystem.playSound('click');
        }
        
        function copyAyahText(ayahText, surahName, ayahNumber) {
            const textToCopy = `${ayahText}\n(${surahName} - الآية ${ayahNumber})`;
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        showNotification('تم النسخ', 'تم نسخ الآية');
                        audioSystem.playSound('notification');
                    })
                    .catch(() => showNotification('خطأ', 'تعذر نسخ النص'));
            } else {
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('تم النسخ', 'تم نسخ الآية');
                audioSystem.playSound('notification');
            }
        }
        
        // ==================== نظام الأذكار مع API محسن ====================
        async function loadAzkar() {
            try {
                // جلب الأذكار من API الأولى
                const response1 = await fetch('https://raw.githubusercontent.com/nawafalqari/azkar-api/main/azkar.json');
                const data1 = await response1.json();
                
                if (data1) {
                    displayAzkarFromAPI(data1);
                } else {
                    loadDefaultAzkar();
                }
            } catch (error) {
                console.error('Error fetching azkar:', error);
                loadDefaultAzkar();
            }
        }
        
        function displayAzkarFromAPI(azkarData) {
            // عرض أذكار الصباح
            displayAzkarCategory('morning', 'أذكار الصباح');
            displayAzkarCategory('evening', 'أذكار المساء');
            displayAzkarCategory('sleep', 'أذكار النوم');
            displayAzkarCategory('prayer', 'أذكار الصلاة');
            displayAzkarCategory('general', 'أذكار عامة');
        }
        
        function displayAzkarCategory(categoryId, categoryName) {
            const container = document.getElementById(`${categoryId}Azkar`);
            if (!container) return;
            
            // استخدام بيانات افتراضية مؤقتة
            const azkarData = getDefaultAzkarForCategory(categoryId);
            displayAzkarList(categoryId, azkarData);
        }
        
        function getDefaultAzkarForCategory(categoryId) {
            const azkarData = {
                morning: [
                    {
                        text: "أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ للهِ، وَالْحَمْدُ للهِ، لا إلهَ إلا اللهُ وَحْدَهُ لا شَرِيكَ له، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ، وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ",
                        description: "من قالها حين يصبح أُعِيطَ من الأجر كأنما أعتق رقبة من ولد إسماعيل",
                        count: "1"
                    },
                    {
                        text: "اللَّهُمَّ بِكَ أَصْبَحْنَا، وَبِكَ أَمْسَيْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ النُّشُورُ",
                        description: "",
                        count: "1"
                    },
                    {
                        text: "اللَّهُمَّ أَنْتَ رَبِّي لا إِلَهَ إِلا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لا يَغْفِرُ الذُّنُوبَ إِلا أَنْتَ",
                        description: "من قالها حين يصبح موقنا بها فمات من يومه دخل الجنة",
                        count: "1"
                    }
                ],
                evening: [
                    {
                        text: "أَمْسَيْنَا وَأَمْسَى الْمُلْكُ للهِ، وَالْحَمْدُ للهِ، لا إلهَ إلا اللهُ وَحْدَهُ لا شَرِيكَ له، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ، وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ",
                        description: "من قالها حين يمسي أُعِيطَ من الأجر كأنما أعتق رقبة من ولد إسماعيل",
                        count: "1"
                    },
                    {
                        text: "اللَّهُمَّ بِكَ أَمْسَيْنَا، وَبِكَ أَصْبَحْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ، وَإِلَيْكَ الْمَصِيرُ",
                        description: "",
                        count: "1"
                    }
                ],
                sleep: [
                    {
                        text: "بِاسْمِكَ رَبِّي وَضَعْتُ جَنْبِي، وَبِكَ أَرْفَعُهُ، إِنْ أَمْسَكْتَ نَفْسِي فَارْحَمْهَا، وَإِنْ أَرْسَلْتَهَا فَاحْفَظْهَا بِمَا تَحْفَظُ بِهِ عِبَادَكَ الصَّالِحِينَ",
                        description: "",
                        count: "1"
                    },
                    {
                        text: "اللَّهُمَّ قِنِي عَذَابَكَ يَوْمَ تَبْعَثُ عِبَادَكَ",
                        description: "",
                        count: "3"
                    }
                ],
                prayer: [
                    {
                        text: "سُبْحَانَ اللهِ، وَالْحَمْدُ للهِ، وَلا إِلَهَ إِلا اللهُ، وَاللهُ أَكْبَرُ",
                        description: "من قالها في دبر كل صلاة غفرت ذنوبه وإن كانت مثل زبد البحر",
                        count: "33"
                    },
                    {
                        text: "لا إِلَهَ إِلا اللهُ وَحْدَهُ لا شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ",
                        description: "من قالها عشر مرات بعد المغرب والصبح كتب الله له أجر عتق رقبة",
                        count: "10"
                    }
                ],
                general: [
                    {
                        text: "سُبْحَانَ اللهِ وَبِحَمْدِهِ، سُبْحَانَ اللهِ الْعَظِيمِ",
                        description: "ثقيلتان في الميزان حبيبتان إلى الرحمن",
                        count: "100"
                    },
                    {
                        text: "لا حَوْلَ وَلا قُوَّةَ إِلا بِاللهِ",
                        description: "كنز من كنوز الجنة",
                        count: "100"
                    }
                ]
            };
            
            return azkarData[categoryId] || [];
        }
        
        function displayAzkarList(categoryId, azkarList) {
            const container = document.getElementById(`${categoryId}Azkar`);
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!azkarList || azkarList.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #aaa; padding: 20px;">لا توجد أذكار متاحة حالياً</p>';
                return;
            }
            
            azkarList.forEach((azkar, index) => {
                const azkarCard = document.createElement('div');
                azkarCard.className = 'card glass-effect';
                azkarCard.style.marginBottom = '15px';
                
                const azkarText = azkar.text || azkar.content || '';
                const description = azkar.description || azkar.fadl || '';
                const count = azkar.count || 1;
                
                azkarCard.innerHTML = `
                    <div style="font-size: 1.4rem; line-height: 2; margin-bottom: 15px; text-align: center;">
                        ${azkarText}
                    </div>
                    ${description ? `<div style="color: #aaa; text-align: center; margin-bottom: 15px; font-size: 0.9rem;">${description}</div>` : ''}
                    <div class="azkar-counter">
                        <button class="btn" onclick="completeAzkar(this)" style="flex: 1;">
                            <i class="fas fa-check"></i> تمت الذكر
                        </button>
                        <div class="count-controls">
                            <button class="count-btn" onclick="changeAzkarCount(this, -1)">-</button>
                            <span class="current-count">${count}</span>
                            <button class="count-btn" onclick="changeAzkarCount(this, 1)">+</button>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                `;
                
                container.appendChild(azkarCard);
            });
        }
        
        function loadDefaultAzkar() {
            const morningAzkar = [
                {
                    text: "أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ للهِ، وَالْحَمْدُ للهِ، لا إلهَ إلا اللهُ وَحْدَهُ لا شَرِيكَ له، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ، وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ",
                    description: "من قالها حين يصبح أُعِيطَ من الأجر كأنما أعتق رقبة من ولد إسماعيل",
                    count: "1"
                }
            ];
            
            displayAzkarList('morning', morningAzkar);
            displayAzkarList('evening', []);
            displayAzkarList('sleep', []);
            displayAzkarList('prayer', []);
            displayAzkarList('general', []);
        }
        
        function showAzkarTab(tab) {
            document.querySelectorAll('.azkar-tab').forEach(t => {
                t.classList.remove('active');
            });
            
            document.querySelectorAll('.azkar-content').forEach(content => {
                content.style.display = 'none';
            });
            
            const targetTab = document.querySelector(`.azkar-tab[onclick*="${tab}"]`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            document.getElementById(`${tab}Azkar`).style.display = 'block';
            audioSystem.playSound('section');
        }
        
        function changeAzkarCount(button, amount) {
            const counter = button.closest('.azkar-counter');
            const countSpan = counter.querySelector('.current-count');
            let currentCount = parseInt(countSpan.textContent) || 1;
            
            currentCount += amount;
            if (currentCount < 1) currentCount = 1;
            if (currentCount > 1000) currentCount = 1000;
            
            countSpan.textContent = currentCount;
            
            const progressBar = counter.nextElementSibling.querySelector('.progress-fill');
            progressBar.style.width = '0%';
            
            audioSystem.playSound('click');
        }
        
        function completeAzkar(button) {
            const counter = button.closest('.azkar-counter');
            const countSpan = counter.querySelector('.current-count');
            const totalCount = parseInt(countSpan.textContent) || 1;
            
            const progressBar = counter.nextElementSibling.querySelector('.progress-fill');
            progressBar.style.width = '100%';
            
            button.style.background = '#27ae60';
            button.innerHTML = '<i class="fas fa-check-circle"></i> مكتمل';
            button.disabled = true;
            
            showNotification('مبارك!', `أتممت ${totalCount} ذكر`);
            audioSystem.playSound('notification');
            
            setTimeout(() => {
                progressBar.style.width = '0%';
                button.style.background = '';
                button.innerHTML = '<i class="fas fa-check"></i> تمت الذكر';
                button.disabled = false;
            }, 2000);
        }
        
        // ==================== نظام الأحاديث مع APIs متعددة ====================
        async function loadHadiths() {
            try {
                // تحميل أحاديث مسلم
                const muslimResponse = await fetch('https://hadis-api-id.vercel.app/hadits/muslim?page=1&limit=50');
                const muslimData = await muslimResponse.json();
                
                if (muslimData && muslimData.data) {
                    hadiths.muslim = muslimData.data.map(item => ({
                        text: item.arab,
                        source: `صحيح مسلم - ${item.id}`
                    }));
                }
                
                // تحميل أحاديث البخاري
                const bukhariResponse = await fetch('https://hadis-api-id.vercel.app/hadits/bukhari?page=1&limit=50');
                const bukhariData = await bukhariResponse.json();
                
                if (bukhariData && bukhariData.data) {
                    hadiths.bukhari = bukhariData.data.map(item => ({
                        text: item.arab,
                        source: `صحيح البخاري - ${item.id}`
                    }));
                }
                
                // إنشاء قائمة مختلطة
                hadiths.mixed = [...hadiths.muslim, ...hadiths.bukhari];
                
                // تحميل حديث عشوائي عند البدء
                loadRandomHadith();
                
                showNotification('تم', 'تم تحميل الأحاديث بنجاح');
                
            } catch (error) {
                console.error('Error loading hadiths:', error);
                loadDefaultHadiths();
            }
        }
        
        function loadDefaultHadiths() {
            hadiths.mixed = [
                {
                    text: "قال رسول الله صلى الله عليه وسلم: 'مَن صَلَّى عَلَيَّ وَاحِدَةً صَلَّى اللَّهُ عَلَيْهِ عَشْرًا'",
                    source: "صحيح مسلم"
                },
                {
                    text: "قال رسول الله صلى الله عليه وسلم: 'اتَّقِ اللَّهَ حَيْثُمَا كُنْتَ، وَأَتْبِعِ السَّيِّئَةَ الْحَسَنَةَ تَمْحُهَا، وَخَالِقِ النَّاسَ بِخُلُقٍ حَسَنٍ'",
                    source: "رواه الترمذي"
                },
                {
                    text: "قال رسول الله صلى الله عليه وسلم: 'إِنَّمَا الأَعْمَالُ بِالنِّيَّاتِ، وَإِنَّمَا لِكُلِّ امْرِئٍ مَا نَوَى'",
                    source: "رواه البخاري ومسلم"
                },
                {
                    text: "قال رسول الله صلى الله عليه وسلم: 'لا يُؤْمِنُ أَحَدُكُمْ حَتَّى يُحِبَّ لأَخِيهِ مَا يُحِبُّ لِنَفْسِهِ'",
                    source: "رواه البخاري ومسلم"
                },
                {
                    text: "قال رسول الله صلى الله عليه وسلم: 'الكَيِّسُ مَنْ دَانَ نَفْسَهُ، وَعَمِلَ لِمَا بَعْدَ الْمَوْتِ، وَالْعَاجِزُ مَنْ أَتْبَعَ نَفْسَهُ هَوَاهَا، وَتَمَنَّى عَلَى اللَّهِ'",
                    source: "رواه الترمذي"
                }
            ];
            
            hadiths.muslim = hadiths.mixed;
            hadiths.bukhari = hadiths.mixed;
            
            loadRandomHadith();
        }
        
        function setHadithSource(source) {
            currentHadithSource = source;
            
            // تحديث أزرار المصادر
            document.querySelectorAll('[onclick*="setHadithSource"]').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            
            loadRandomHadith();
            showNotification('تم التغيير', `تم تعيين مصدر الأحاديث إلى ${source === 'muslim' ? 'صحيح مسلم' : source === 'bukhari' ? 'صحيح البخاري' : 'مختلط'}`);
            audioSystem.playSound('section');
        }
        
        function loadRandomHadith() {
            const currentHadiths = hadiths[currentHadithSource] || hadiths.mixed;
            
            if (!currentHadiths || currentHadiths.length === 0) {
                document.getElementById('currentHadithText').textContent = "جاري تحميل الأحاديث...";
                document.getElementById('currentHadithRef').textContent = "";
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * currentHadiths.length);
            const hadith = currentHadiths[randomIndex];
            
            const hadithTextElement = document.getElementById('currentHadithText');
            const hadithRefElement = document.getElementById('currentHadithRef');
            
            if (hadithTextElement) {
                hadithTextElement.textContent = hadith.text || '';
            }
            
            if (hadithRefElement) {
                hadithRefElement.textContent = `[${hadith.source}]`;
            }
            
            audioSystem.playSound('section');
        }
        
        function copyHadith() {
            const hadithText = document.getElementById('currentHadithText').textContent;
            const hadithRef = document.getElementById('currentHadithRef').textContent;
            const textToCopy = `${hadithText}\n${hadithRef}`;
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        showNotification('تم النسخ', 'تم نسخ الحديث');
                        audioSystem.playSound('notification');
                    })
                    .catch(() => showNotification('خطأ', 'تعذر نسخ الحديث'));
            } else {
                // طريقة بديلة
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('تم النسخ', 'تم نسخ الحديث');
                audioSystem.playSound('notification');
            }
        }
        
        function shareHadith() {
            const hadithText = document.getElementById('currentHadithText').textContent;
            const hadithRef = document.getElementById('currentHadithRef').textContent;
            const shareText = `${hadithText}\n${hadithRef}\n\nمشاركة من تطبيق رعد`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'حديث شريف',
                    text: shareText,
                    url: window.location.href
                }).catch(() => {
                    // إذا فشلت المشاركة، استخدم النسخ
                    copyHadith();
                });
            } else {
                copyHadith();
            }
        }
        
        // ==================== نظام المسبحة ====================
        let tasbihCount = 0;
        let tasbihType = 'subhanallah';
        
        function incrementTasbih() {
            tasbihCount++;
            
            if (tasbihType === 'subhanallah') {
                tasbihStats.subhan++;
                document.getElementById('todaySubhan').textContent = tasbihStats.subhan;
            } else if (tasbihType === 'alhamdulillah') {
                tasbihStats.hamd++;
                document.getElementById('todayHamd').textContent = tasbihStats.hamd;
            } else if (tasbihType === 'allahuakbar') {
                tasbihStats.takbir++;
                document.getElementById('todayTakbir').textContent = tasbihStats.takbir;
            }
            
            updateTasbihDisplay();
            saveStats();
            audioSystem.playSound('click');
            
            // إشعارات عند الوصول إلى أعداد معينة
            if (tasbihCount === 33 || tasbihCount === 66 || tasbihCount === 99 || tasbihCount === 100) {
                showNotification('مبارك!', `أتممت ${tasbihCount} تسبيحة`);
                audioSystem.playSound('notification');
            }
        }
        
        function changeTasbih(amount) {
            tasbihCount += amount;
            if (tasbihCount < 0) tasbihCount = 0;
            updateTasbihDisplay();
            audioSystem.playSound('click');
        }
        
        function resetTasbih() {
            tasbihCount = 0;
            updateTasbihDisplay();
            showNotification('تم', 'تم إعادة تعيين المسبحة');
            audioSystem.playSound('notification');
        }
        
        function setTasbihType(type) {
            tasbihType = type;
            const texts = {
                'subhanallah': 'سبحان الله',
                'alhamdulillah': 'الحمد لله',
                'allahuakbar': 'الله أكبر'
            };
            
            const displayElement = document.getElementById('currentTasbih');
            if (displayElement) {
                displayElement.textContent = texts[type] || 'سبحان الله';
            }
            audioSystem.playSound('click');
        }
        
        function updateTasbihDisplay() {
            const counterElement = document.getElementById('counter');
            if (counterElement) {
                counterElement.textContent = tasbihCount;
            }
        }
        
        // ==================== نظام الصلاة ====================
        async function getPrayerTimes() {
            try {
                const city = document.getElementById('cityInput').value || 'مكة';
                const country = document.getElementById('countryInput').value || 'السعودية';
                const method = prayerSettings.method;
                
                showNotification('جاري الحساب', `جاري حساب أوقات الصلاة لـ ${city}`);
                
                const response = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=${method}`);
                const data = await response.json();
                
                if (data.code === 200) {
                    currentPrayerTimes = data.data.timings;
                    
                    // جلب التاريخ الهجري
                    const hijriDate = data.data.date.hijri;
                    const hijriDateElement = document.getElementById('hijriDate');
                    if (hijriDateElement) {
                        hijriDateElement.textContent = `${hijriDate.day} ${hijriDate.month.ar} ${hijriDate.year}هـ`;
                    }
                    
                    updatePrayerTimesDisplay();
                    startNextPrayerTimer();
                    
                    showNotification('تم', `تم حساب أوقات الصلاة لـ ${city}`);
                    audioSystem.playSound('notification');
                    
                    // حفظ الإعدادات
                    prayerSettings.city = city;
                    prayerSettings.country = country;
                    saveSettings();
                }
            } catch (error) {
                console.error('Error getting prayer times:', error);
                showNotification('خطأ', 'تعذر حساب أوقات الصلاة. تحقق من اتصالك بالإنترنت');
                
                // استخدام أوقات افتراضية
                useDefaultPrayerTimes();
            }
        }
        
        function useDefaultPrayerTimes() {
            currentPrayerTimes = {
                Fajr: '05:00',
                Sunrise: '06:00',
                Dhuhr: '12:30',
                Asr: '15:45',
                Maghrib: '18:20',
                Isha: '19:45'
            };
            
            updatePrayerTimesDisplay();
            showNotification('تنبيه', 'تم استخدام أوقات افتراضية');
        }
        
        async function getUserLocation() {
            if (navigator.geolocation) {
                showNotification('جاري البحث', 'جاري تحديد موقعك...');
                
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        currentLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        try {
                            // استخدام خدمة عكسية لتحديد المدينة والبلد
                            const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${currentLocation.lat}&longitude=${currentLocation.lng}&localityLanguage=ar`);
                            const locationData = await response.json();
                            
                            if (locationData.city && locationData.countryName) {
                                document.getElementById('cityInput').value = locationData.city;
                                document.getElementById('countryInput').value = locationData.countryName;
                                getPrayerTimes();
                            } else {
                                // إذا لم نحصل على اسم المدينة، استخدم الإحداثيات مباشرة
                                getPrayerTimesByCoordinates();
                            }
                        } catch (error) {
                            // استخدم الإحداثيات مباشرة
                            getPrayerTimesByCoordinates();
                        }
                    },
                    (error) => {
                        console.error('Geolocation error:', error);
                        showNotification('خطأ', 'تعذر تحديد موقعك الجغرافي. الرجاء إدخال الموقع يدوياً');
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                showNotification('خطأ', 'المتصفح لا يدعم تحديد الموقع الجغرافي');
            }
        }
        
        async function getPrayerTimesByCoordinates() {
            if (!currentLocation) return;
            
            try {
                const response = await fetch(`https://api.aladhan.com/v1/timings/${Math.floor(Date.now() / 1000)}?latitude=${currentLocation.lat}&longitude=${currentLocation.lng}&method=${prayerSettings.method}`);
                const data = await response.json();
                
                if (data.code === 200) {
                    currentPrayerTimes = data.data.timings;
                    updatePrayerTimesDisplay();
                    showNotification('تم', 'تم حساب أوقات الصلاة من موقعك');
                }
            } catch (error) {
                showNotification('خطأ', 'تعذر حساب أوقات الصلاة من موقعك');
            }
        }
        
        function updateDateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const dateStr = now.toLocaleDateString('ar-SA', { 
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const timeElement = document.getElementById('currentTime');
            const dateElement = document.getElementById('currentDate');
            
            if (timeElement) timeElement.textContent = timeStr;
            if (dateElement) dateElement.textContent = dateStr;
            
            updateCurrentPrayer();
            updateNextPrayerTime();
        }
        
        function updatePrayerTimesDisplay() {
            const prayerTimesContainer = document.getElementById('prayerTimes');
            if (!prayerTimesContainer || !currentPrayerTimes) return;
            
            const prayers = [
                { name: 'الفجر', time: currentPrayerTimes.Fajr, key: 'Fajr', icon: 'fas fa-sun' },
                { name: 'الشروق', time: currentPrayerTimes.Sunrise, key: 'Sunrise', icon: 'fas fa-sunrise' },
                { name: 'الظهر', time: currentPrayerTimes.Dhuhr, key: 'Dhuhr', icon: 'fas fa-sun' },
                { name: 'العصر', time: currentPrayerTimes.Asr, key: 'Asr', icon: 'fas fa-sun' },
                { name: 'المغرب', time: currentPrayerTimes.Maghrib, key: 'Maghrib', icon: 'fas fa-moon' },
                { name: 'العشاء', time: currentPrayerTimes.Isha, key: 'Isha', icon: 'fas fa-moon' }
            ];
            
            let html = '';
            prayers.forEach(prayer => {
                if (currentPrayerTimes[prayer.key]) {
                    html += `
                        <div class="prayer-time-card glass-effect" data-prayer="${prayer.key}">
                            <div style="font-size: 1.2rem; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                <i class="${prayer.icon}" style="color: var(--gold);"></i>
                                <span>${prayer.name}</span>
                            </div>
                            <div class="time">${currentPrayerTimes[prayer.key]}</div>
                        </div>
                    `;
                }
            });
            
            prayerTimesContainer.innerHTML = html;
            
            updateCurrentPrayer();
        }
        
        function updateCurrentPrayer() {
            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();
            
            if (!currentPrayerTimes || Object.keys(currentPrayerTimes).length === 0) return;
            
            const prayerMinutes = {};
            Object.keys(currentPrayerTimes).forEach(key => {
                const time = currentPrayerTimes[key];
                if (time && time.includes(':')) {
                    prayerMinutes[key] = convertTimeToMinutes(time);
                }
            });
            
            document.querySelectorAll('.prayer-time-card').forEach(card => {
                card.classList.remove('current');
            });
            
            const prayerOrder = ['Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            
            for (let i = 0; i < prayerOrder.length - 1; i++) {
                const current = prayerOrder[i];
                const next = prayerOrder[i + 1];
                
                if (prayerMinutes[current] && prayerMinutes[next]) {
                    if (currentTime >= prayerMinutes[current] && currentTime < prayerMinutes[next]) {
                        const currentCard = document.querySelector(`.prayer-time-card[data-prayer="${current}"]`);
                        if (currentCard) {
                            currentCard.classList.add('current');
                        }
                        break;
                    }
                }
            }
        }
        
        function updateNextPrayerTime() {
            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();
            
            if (!currentPrayerTimes || Object.keys(currentPrayerTimes).length === 0) return;
            
            const prayerMinutes = {};
            const prayerNames = {
                'Fajr': 'الفجر',
                'Dhuhr': 'الظهر',
                'Asr': 'العصر',
                'Maghrib': 'المغرب',
                'Isha': 'العشاء'
            };
            
            Object.keys(currentPrayerTimes).forEach(key => {
                const time = currentPrayerTimes[key];
                if (time && time.includes(':')) {
                    prayerMinutes[key] = convertTimeToMinutes(time);
                }
            });
            
            let nextPrayer = null;
            let minDiff = Infinity;
            
            for (const [prayer, time] of Object.entries(prayerMinutes)) {
                if (prayerNames[prayer] && time > currentTime && time - currentTime < minDiff) {
                    minDiff = time - currentTime;
                    nextPrayer = prayer;
                }
            }
            
            // إذا لم يكن هناك صلاة قادمة (أي بعد العشاء)، فالصلاة القادمة هي الفجر
            if (!nextPrayer) {
                nextPrayer = 'Fajr';
                const fajrTime = prayerMinutes['Fajr'] || 0;
                minDiff = (24 * 60 - currentTime) + fajrTime;
            }
            
            if (nextPrayer) {
                const nextPrayerNameElement = document.getElementById('nextPrayerName');
                const nextPrayerTimeElement = document.getElementById('nextPrayerTime');
                const timeRemainingElement = document.getElementById('timeRemaining');
                
                if (nextPrayerNameElement) {
                    nextPrayerNameElement.textContent = prayerNames[nextPrayer];
                }
                
                if (nextPrayerTimeElement && currentPrayerTimes[nextPrayer]) {
                    nextPrayerTimeElement.textContent = currentPrayerTimes[nextPrayer];
                }
                
                if (timeRemainingElement && minDiff > 0) {
                    const hours = Math.floor(minDiff / 60);
                    const minutes = Math.floor(minDiff % 60);
                    const seconds = 60 - now.getSeconds();
                    
                    timeRemainingElement.textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }
        }
        
        function startNextPrayerTimer() {
            if (nextPrayerTimer) {
                clearInterval(nextPrayerTimer);
            }
            
            nextPrayerTimer = setInterval(() => {
                updateNextPrayerTime();
            }, 1000);
        }
        
        function setPrayerMethod(method) {
            prayerSettings.method = method;
            
            document.querySelectorAll('.prayer-method-card').forEach(card => {
                card.classList.remove('active');
            });
            
            if (event && event.target) {
                const card = event.target.closest('.prayer-method-card');
                if (card) {
                    card.classList.add('active');
                }
            }
            
            showNotification('تم التغيير', `تم تعيين المذهب الحسابي`);
            audioSystem.playSound('notification');
            
            // إعادة حساب أوقات الصلاة
            getPrayerTimes();
        }
        
        function convertTimeToMinutes(timeStr) {
            if (!timeStr || !timeStr.includes(':')) return 0;
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }
        
        // ==================== نظام القبلة ====================
        function getCurrentLocationForQibla() {
            if (navigator.geolocation) {
                showNotification('جاري البحث', 'جاري تحديد موقعك...');
                
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        currentLocation = { lat, lng };
                        
                        try {
                            // استخدام API مباشر لحساب القبلة
                            const response = await fetch(`https://api.aladhan.com/v1/qibla/${lat}/${lng}`);
                            const data = await response.json();
                            
                            if (data.code === 200) {
                                qiblaDirection = data.data.direction;
                                
                                // تحديث البوصلة
                                updateCompass(qiblaDirection);
                                
                                // تحديث العرض
                                const qiblaDirectionElement = document.getElementById('qiblaDirection');
                                const qiblaLocationElement = document.getElementById('qiblaLocation');
                                
                                if (qiblaDirectionElement) {
                                    qiblaDirectionElement.textContent = `${Math.round(qiblaDirection)}°`;
                                }
                                
                                if (qiblaLocationElement) {
                                    qiblaLocationElement.textContent = `اتجاه القبلة من موقعك: ${Math.round(qiblaDirection)} درجة`;
                                }
                                
                                showNotification('تم', 'تم حساب اتجاه القبلة من موقعك الحالي');
                                audioSystem.playSound('notification');
                            }
                        } catch (error) {
                            console.error('Error fetching qibla direction:', error);
                            // استخدام الحساب المحلي كبديل
                            calculateLocalQibla(lat, lng);
                        }
                    },
                    (error) => {
                        console.error('Geolocation error:', error);
                        showNotification('خطأ', 'تعذر تحديد موقعك الجغرافي');
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                showNotification('خطأ', 'المتصفح لا يدعم تحديد الموقع الجغرافي');
            }
        }
        
        function calculateLocalQibla(lat, lng) {
            // إحداثيات الكعبة في مكة المكرمة
            const kaabaLat = 21.4225;   // خط عرض الكعبة
            const kaabaLng = 39.8262;   // خط طول الكعبة
            
            // تحويل الدرجات إلى راديان
            const φ1 = lat * Math.PI / 180;
            const φ2 = kaabaLat * Math.PI / 180;
            const Δλ = (kaabaLng - lng) * Math.PI / 180;
            
            // حساب اتجاه القبلة باستخدام صيغة حساب الزاوية العظمى
            const y = Math.sin(Δλ);
            const x = Math.cos(φ1) * Math.tan(φ2) - Math.sin(φ1) * Math.cos(Δλ);
            
            let θ = Math.atan2(y, x);
            
            // تحويل الراديان إلى درجات
            θ = θ * 180 / Math.PI;
            
            // ضبط القيمة لتكون بين 0 و 360 درجة
            qiblaDirection = (θ + 360) % 360;
            
            // تحديث البوصلة
            updateCompass(qiblaDirection);
            
            // تحديث العرض
            const qiblaDirectionElement = document.getElementById('qiblaDirection');
            const qiblaLocationElement = document.getElementById('qiblaLocation');
            
            if (qiblaDirectionElement) {
                qiblaDirectionElement.textContent = `${Math.round(qiblaDirection)}°`;
            }
            
            if (qiblaLocationElement) {
                qiblaLocationElement.textContent = `اتجاه القبلة من موقعك: ${Math.round(qiblaDirection)} درجة`;
            }
        }
        
        function updateCompass(direction) {
            const needle = document.getElementById('compassNeedle');
            if (needle) {
                needle.style.transform = `translate(-50%, -50%) rotate(${direction}deg)`;
            }
        }
        
        // ==================== نظام أسماء الله الحسنى ====================
        async function loadAsma() {
            try {
                // بيانات أسماء الله الحسنى الكاملة
                allAsma = [
                    { arabic: 'الرَّحْمَنُ', meaning: 'ذو الرحمة الواسعة' },
                    { arabic: 'الرَّحِيمُ', meaning: 'الرحيم بعباده' },
                    { arabic: 'الْمَلِكُ', meaning: 'الملك الكامل' },
                    { arabic: 'الْقُدُّوسُ', meaning: 'المقدس المنزه' },
                    { arabic: 'السَّلَامُ', meaning: 'مصدر السلام' },
                    { arabic: 'الْمُؤْمِنُ', meaning: 'المؤمن لعباده' },
                    { arabic: 'الْمُهَيْمِنُ', meaning: 'المهيمن على الخلق' },
                    { arabic: 'الْعَزِيزُ', meaning: 'العزيز الذي لا يغلب' },
                    { arabic: 'الْجَبَّارُ', meaning: 'الجبار القهار' },
                    { arabic: 'الْمُتَكَبِّرُ', meaning: 'المتكبر عن كل سوء' },
                    { arabic: 'الْخَالِقُ', meaning: 'الخالق لكل شيء' },
                    { arabic: 'الْبَارِئُ', meaning: 'البارئ المصور' },
                    { arabic: 'الْمُصَوِّرُ', meaning: 'المصور للأشكال' },
                    { arabic: 'الْغَفَّارُ', meaning: 'الغفار للذنوب' },
                    { arabic: 'الْقَهَّارُ', meaning: 'القهار للخلق' },
                    { arabic: 'الْوَهَّابُ', meaning: 'الوهاب الكثير العطاء' },
                    { arabic: 'الرَّزَّاقُ', meaning: 'الرزاق الواسع الرزق' },
                    { arabic: 'الْفَتَّاحُ', meaning: 'الفتاح يفتح الخير' },
                    { arabic: 'الْعَلِيمُ', meaning: 'العليم بكل شيء' },
                    { arabic: 'الْقَابِضُ', meaning: 'القابض للأرزاق' },
                    { arabic: 'الْبَاسِطُ', meaning: 'الباسط للأرزاق' },
                    { arabic: 'الْخَافِضُ', meaning: 'الخافض للمتكبرين' },
                    { arabic: 'الرَّافِعُ', meaning: 'الرافع للمؤمنين' },
                    { arabic: 'الْمُعِزُّ', meaning: 'المعز لأوليائه' },
                    { arabic: 'المُذِلُّ', meaning: 'المذل لأعدائه' },
                    { arabic: 'السَّمِيعُ', meaning: 'السميع لكل شيء' },
                    { arabic: 'الْبَصِيرُ', meaning: 'البصير بكل شيء' },
                    { arabic: 'الْحَكَمُ', meaning: 'الحكم العدل' },
                    { arabic: 'الْعَدْلُ', meaning: 'العادل في حكمه' },
                    { arabic: 'اللَّطِيفُ', meaning: 'اللطيف بعباده' },
                    { arabic: 'الْخَبِيرُ', meaning: 'الخبير ببواطن الأمور' },
                    { arabic: 'الْحَلِيمُ', meaning: 'الحليم الصبور' },
                    { arabic: 'الْعَظِيمُ', meaning: 'العظيم في ذاته وصفاته' },
                    { arabic: 'الْغَفُورُ', meaning: 'الغفور للسائلين' },
                    { arabic: 'الشَّكُورُ', meaning: 'الشكور للقليل من العمل' },
                    { arabic: 'الْعَلِيُّ', meaning: 'العلي في درجاته' },
                    { arabic: 'الْكَبِيرُ', meaning: 'الكبير المتعالي' },
                    { arabic: 'الْحَفِيظُ', meaning: 'الحفيظ على خلقه' },
                    { arabic: 'الْمُقِيتُ', meaning: 'المقيت المقتدر' },
                    { arabic: 'الْحَسِيبُ', meaning: 'الحسيب الكافي' },
                    { arabic: 'الْجَلِيلُ', meaning: 'الجليل العظيم' },
                    { arabic: 'الْكَرِيمُ', meaning: 'الكريم الواسع العطاء' },
                    { arabic: 'الرَّقِيبُ', meaning: 'الرقيب المطلع' },
                    { arabic: 'الْمُجِيبُ', meaning: 'المجيب للدعاء' },
                    { arabic: 'الْوَاسِعُ', meaning: 'الواسع العلم والرحمة' },
                    { arabic: 'الْحَكِيمُ', meaning: 'الحكيم في أفعاله' },
                    { arabic: 'الْوَدُودُ', meaning: 'الودود المحب' },
                    { arabic: 'الْمَجِيدُ', meaning: 'المجيد الكريم' },
                    { arabic: 'الْبَاعِثُ', meaning: 'الباعث من القبور' },
                    { arabic: 'الشَّهِيدُ', meaning: 'الشهيد المطلع' },
                    { arabic: 'الْحَقُّ', meaning: 'الحق الثابت' },
                    { arabic: 'الْوَكِيلُ', meaning: 'الوكيل الكفيل' },
                    { arabic: 'الْقَوِيُّ', meaning: 'القوي في قدرته' },
                    { arabic: 'الْمَتِينُ', meaning: 'المتين الشديد' },
                    { arabic: 'الْوَلِيُّ', meaning: 'الولي الناصر' },
                    { arabic: 'الْحَمِيدُ', meaning: 'الحميد المحمود' },
                    { arabic: 'الْمُحْصِي', meaning: 'المحصي لأعمال العباد' },
                    { arabic: 'الْمُبْدِئُ', meaning: 'المبدئ الخالق' },
                    { arabic: 'الْمُعِيدُ', meaning: 'المعيد المحيي' },
                    { arabic: 'الْمُحْيِي', meaning: 'المحيي للموتى' },
                    { arabic: 'الْمُمِيتُ', meaning: 'المميت للأحياء' },
                    { arabic: 'الْحَيُّ', meaning: 'الحي الدائم' },
                    { arabic: 'الْقَيُّومُ', meaning: 'القيوم القائم بنفسه' },
                    { arabic: 'الْوَاجِدُ', meaning: 'الواجد الغني' },
                    { arabic: 'الْمَاجِدُ', meaning: 'الماجد الكريم' },
                    { arabic: 'الْوَاحِدُ', meaning: 'الواحد الأحد' },
                    { arabic: 'الْأَحَدُ', meaning: 'الأحد الفرد' },
                    { arabic: 'الصَّمَدُ', meaning: 'الصمد المقصود' },
                    { arabic: 'الْقَادِرُ', meaning: 'القادر المقتدر' },
                    { arabic: 'الْمُقْتَدِرُ', meaning: 'المقتدر القوي' },
                    { arabic: 'الْمُقَدِّمُ', meaning: 'المقدم لما شاء' },
                    { arabic: 'الْمُؤَخِّرُ', meaning: 'المؤخر لما شاء' },
                    { arabic: 'الْأَوَّلُ', meaning: 'الأول الذي ليس قبله شيء' },
                    { arabic: 'الْآخِرُ', meaning: 'الآخر الذي ليس بعده شيء' },
                    { arabic: 'الظَّاهِرُ', meaning: 'الظاهر فوق كل شيء' },
                    { arabic: 'الْبَاطِنُ', meaning: 'الباطن الذي ليس دونه شيء' },
                    { arabic: 'الْوَالِي', meaning: 'الوالي المتصرف' },
                    { arabic: 'الْمُتَعَالِي', meaning: 'المتعالي عن النقائص' },
                    { arabic: 'الْبَرُّ', meaning: 'البر المحسن' },
                    { arabic: 'التَّوَّابُ', meaning: 'التواب يقبل التوبة' },
                    { arabic: 'الْمُنْتَقِمُ', meaning: 'المنتقم من الظالمين' },
                    { arabic: 'العَفُوُّ', meaning: 'العفو عن الذنوب' },
                    { arabic: 'الرَّءُوفُ', meaning: 'الرءوف الشفوق' },
                    { arabic: 'مَالِكُ الْمُلْكِ', meaning: 'مالك الملك كله' },
                    { arabic: 'ذُو الْجَلَالِ وَالْإِكْرَامِ', meaning: 'ذو الجلال والإكرام' },
                    { arabic: 'الْمُقْسِطُ', meaning: 'المقسط العادل' },
                    { arabic: 'الْجَامِعُ', meaning: 'الجامع للخلق' },
                    { arabic: 'الْغَنِيُّ', meaning: 'الغني عن الخلق' },
                    { arabic: 'الْمُغْنِي', meaning: 'المغني لمن يشاء' },
                    { arabic: 'الْمَانِعُ', meaning: 'المانع لما يشاء' },
                    { arabic: 'الضَّارُّ', meaning: 'الضار النافع' },
                    { arabic: 'النَّافِعُ', meaning: 'النافع الضار' },
                    { arabic: 'النُّورُ', meaning: 'النور الهادي' },
                    { arabic: 'الْهَادِي', meaning: 'الهادي إلى الصراط' },
                    { arabic: 'الْبَدِيعُ', meaning: 'البديع في خلقه' },
                    { arabic: 'الْبَاقِي', meaning: 'الباقي الدائم' },
                    { arabic: 'الْوَارِثُ', meaning: 'الوارث لكل شيء' },
                    { arabic: 'الرَّشِيدُ', meaning: 'الرشيد الهادي' },
                    { arabic: 'الصَّبُورُ', meaning: 'الصبور الحليم' }
                ];
                
                displayAsma(allAsma);
                showNotification('تم', 'تم تحميل أسماء الله الحسنى');
                
            } catch (error) {
                console.error('Error loading asma:', error);
                loadDefaultAsma();
            }
        }
        
        function loadDefaultAsma() {
            allAsma = [
                { arabic: 'الرَّحْمَنُ', meaning: 'ذو الرحمة الواسعة' },
                { arabic: 'الرَّحِيمُ', meaning: 'الرحيم بعباده' },
                { arabic: 'الْمَلِكُ', meaning: 'الملك الكامل' },
                { arabic: 'الْقُدُّوسُ', meaning: 'المقدس المنزه' },
                { arabic: 'السَّلَامُ', meaning: 'مصدر السلام' }
            ];
            displayAsma(allAsma);
        }
        
        function displayAsma(asmaList) {
            const asmaContainer = document.getElementById('asmaList');
            if (!asmaContainer) return;
            
            asmaContainer.innerHTML = '';
            
            asmaList.forEach((asma, index) => {
                const asmaCard = document.createElement('div');
                asmaCard.className = 'asma-card glass-effect';
                asmaCard.onclick = () => showAsmaDetails(asma);
                
                asmaCard.innerHTML = `
                    <div class="asma-name-arabic">${asma.arabic}</div>
                    <div style="color: #aaa; font-size: 0.9rem; margin-top: 10px;">${asma.meaning}</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 10px;">${index + 1}</div>
                `;
                
                asmaContainer.appendChild(asmaCard);
            });
        }
        
        function showRandomName() {
            if (allAsma.length === 0) return;
            
            const randomIndex = Math.floor(Math.random() * allAsma.length);
            const randomName = allAsma[randomIndex];
            
            showNotification(randomName.arabic, randomName.meaning);
            audioSystem.playSound('notification');
        }
        
        function showAllNames() {
            displayAsma(allAsma);
            audioSystem.playSound('section');
        }
        
        function searchAsma() {
            const searchInput = document.getElementById('searchAsma');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            
            if (!searchTerm) {
                displayAsma(allAsma);
                return;
            }
            
            const filtered = allAsma.filter(asma => 
                asma.arabic.includes(searchTerm) || 
                asma.meaning.includes(searchTerm)
            );
            
            displayAsma(filtered);
        }
        
        function showAsmaDetails(asma) {
            showNotification(asma.arabic, asma.meaning);
            audioSystem.playSound('notification');
        }
        
        // ==================== نظام إذاعة القرآن الكريم ====================
        async function loadRadioStations() {
            try {
                const response = await fetch('https://data-rosy.vercel.app/radio.json');
                const data = await response.json();
                
                if (data && Array.isArray(data)) {
                    displayRadioStations(data);
                    showNotification('تم', `تم تحميل ${data.length} محطة إذاعية`);
                } else {
                    loadDefaultRadioStations();
                }
            } catch (error) {
                console.error('Error loading radio stations:', error);
                loadDefaultRadioStations();
            }
        }
        
        function displayRadioStations(stations) {
            const radioContainer = document.getElementById('radioStations');
            if (!radioContainer) return;
            
            radioContainer.innerHTML = '';
            
            stations.forEach(station => {
                const radioCard = document.createElement('div');
                radioCard.className = 'radio-card glass-effect';
                radioCard.onclick = () => playRadioStation(station);
                
                radioCard.innerHTML = `
                    <div class="radio-icon">
                        <i class="fas fa-radio"></i>
                    </div>
                    <h3 style="margin-bottom: 10px; color: var(--light-text);">${station.name || 'محطة إذاعية'}</h3>
                    <p style="color: #aaa; font-size: 0.9rem; margin-bottom: 15px;">${station.country || 'البلد غير معروف'}</p>
                    <div class="radio-controls">
                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;">
                            <i class="fas fa-play"></i> تشغيل
                        </button>
                    </div>
                `;
                
                radioContainer.appendChild(radioCard);
            });
        }
        
        function loadDefaultRadioStations() {
            const defaultStations = [
                { name: 'إذاعة القرآن الكريم - السعودية', url: 'https://quran.ksu.edu.sa/radio/radio.mp3', country: 'السعودية' },
                { name: 'إذاعة القرآن الكريم - مصر', url: 'http://stream.radiojar.com/quran-radio', country: 'مصر' },
                { name: 'إذاعة القرآن الكريم - الإمارات', url: 'https://stream.radiojar.com/u8q5mdqgpvzuv', country: 'الإمارات' },
                { name: 'إذاعة القرآن الكريم - قطر', url: 'https://stream.radiojar.com/8p5vzhwvwg9uv', country: 'قطر' },
                { name: 'إذاعة القرآن الكريم - الكويت', url: 'https://stream.radiojar.com/quran-kuwait', country: 'الكويت' },
                { name: 'إذاعة القرآن الكريم - الأردن', url: 'https://stream.radiojar.com/quran-jordan', country: 'الأردن' }
            ];
            
            displayRadioStations(defaultStations);
        }
        
        function playRadioStation(station) {
            currentRadioStation = station;
            
            // إيقاف أي إذاعة تعمل حالياً
            if (radioPlayer) {
                stopRadio();
            }
            
            // تحديث المعلومات
            document.getElementById('currentRadioName').textContent = station.name;
            document.getElementById('currentRadioCountry').textContent = station.country || '';
            
            // إظهار مشغل الإذاعة
            document.getElementById('radioPlayer').style.display = 'block';
            
            // تشغيل الإذاعة
            try {
                radioPlayer = new Audio(station.url);
                radioPlayer.play();
                isRadioPlaying = true;
                document.getElementById('radioPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
                
                // تحديث أزرار المحطات
                document.querySelectorAll('.radio-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                if (event && event.target) {
                    const card = event.target.closest('.radio-card');
                    if (card) {
                        card.classList.add('active');
                        card.querySelector('.btn').innerHTML = '<i class="fas fa-pause"></i> إيقاف';
                    }
                }
                
                showNotification('جاري التشغيل', `إذاعة ${station.name}`);
                audioSystem.playSound('notification');
                
                // إضافة مستمعين للأحداث
                radioPlayer.addEventListener('error', function() {
                    showNotification('خطأ', 'تعذر تشغيل الإذاعة. قد يكون الرابط غير صالح');
                    stopRadio();
                });
                
            } catch (error) {
                console.error('Error playing radio:', error);
                showNotification('خطأ', 'تعذر تشغيل الإذاعة');
            }
        }
        
        function playPauseRadio() {
            if (!radioPlayer) return;
            
            if (isRadioPlaying) {
                radioPlayer.pause();
                document.getElementById('radioPlayBtn').innerHTML = '<i class="fas fa-play"></i>';
                isRadioPlaying = false;
            } else {
                radioPlayer.play();
                document.getElementById('radioPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
                isRadioPlaying = true;
            }
            audioSystem.playSound('click');
        }
        
        function stopRadio() {
            if (!radioPlayer) return;
            
            radioPlayer.pause();
            radioPlayer = null;
            isRadioPlaying = false;
            document.getElementById('radioPlayBtn').innerHTML = '<i class="fas fa-play"></i>';
            
            // إعادة تعيين أزرار المحطات
            document.querySelectorAll('.radio-card').forEach(card => {
                card.classList.remove('active');
                card.querySelector('.btn').innerHTML = '<i class="fas fa-play"></i> تشغيل';
            });
            
            document.getElementById('radioPlayer').style.display = 'none';
        }
        
        function seekRadio(event) {
            // للإذاعات المباشرة لا يمكن التحكم في الوقت
            audioSystem.playSound('click');
        }
        
        // ==================== نظام المقالات الإسلامية ====================
        async function loadIslamicArticles() {
            try {
                // استخدام بيانات افتراضية للمقالات
                islamicArticles = [
                    {
                        title: 'فضل الصلاة في الإسلام',
                        description: 'مقال يتحدث عن أهمية الصلاة وفضلها في الإسلام، وكيف أنها عماد الدين وأول ما يحاسب عليه العبد يوم القيامة.',
                        category_name: 'الصلاة',
                        created_at: '2024-01-15',
                        views: 1250,
                        link: 'https://www.islamweb.net/ar/article/135500/'
                    },
                    {
                        title: 'أهمية بر الوالدين',
                        description: 'مقال يتناول أهمية بر الوالدين في الإسلام، وفضله العظيم، وعاقبة عقوق الوالدين.',
                        category_name: 'الأخلاق',
                        created_at: '2024-01-10',
                        views: 980,
                        link: 'https://www.islamweb.net/ar/article/135501/'
                    },
                    {
                        title: 'الاستغفار وأثره في حياة المسلم',
                        description: 'مقال عن فضل الاستغفار وكثرة الذكر، وكيف يغير الله حال العبد من الضيق إلى السعة.',
                        category_name: 'العبادات',
                        created_at: '2024-01-05',
                        views: 750,
                        link: 'https://www.islamweb.net/ar/article/135502/'
                    },
                    {
                        title: 'الصبر في الشدائد',
                        description: 'كيف يكون الصبر عند المصيبة، وفضل الصابرين، وأجرهم عند الله تعالى.',
                        category_name: 'التزكية',
                        created_at: '2024-01-01',
                        views: 620,
                        link: 'https://www.islamweb.net/ar/article/135503/'
                    },
                    {
                        title: 'فضل قراءة القرآن الكريم',
                        description: 'الأجر العظيم لقراءة القرآن وتدبره، وكيف يكون شفيعاً لصاحبه يوم القيامة.',
                        category_name: 'القرآن',
                        created_at: '2023-12-28',
                        views: 1100,
                        link: 'https://www.islamweb.net/ar/article/135504/'
                    },
                    {
                        title: 'أحكام الزكاة وشروطها',
                        description: 'شرح مفصل لأحكام الزكاة، وشروطها، ومقاديرها، والأصناف التي تجب فيها.',
                        category_name: 'الفقه',
                        created_at: '2023-12-25',
                        views: 890,
                        link: 'https://www.islamweb.net/ar/article/135505/'
                    },
                    {
                        title: 'التوكل على الله',
                        description: 'معنى التوكل الحقيقي، والفرق بينه وبين التواكل، وثمار التوكل على الله.',
                        category_name: 'التزكية',
                        created_at: '2023-12-20',
                        views: 540,
                        link: 'https://www.islamweb.net/ar/article/135506/'
                    },
                    {
                        title: 'أخلاق النبي صلى الله عليه وسلم',
                        description: 'سرد لأخلاق الرسول صلى الله عليه وسلم مع أصحابه وأهل بيته وأعدائه.',
                        category_name: 'السيرة',
                        created_at: '2023-12-15',
                        views: 1320,
                        link: 'https://www.islamweb.net/ar/article/135507/'
                    }
                ];
                
                // استخراج الفئات
                articleCategories.clear();
                islamicArticles.forEach(article => {
                    if (article.category_name) {
                        articleCategories.add(article.category_name);
                    }
                });
                
                // عرض الفئات
                displayArticleCategories();
                
                // عرض المقالات
                displayArticles(islamicArticles);
                
                showNotification('تم', `تم تحميل ${islamicArticles.length} مقالة إسلامية`);
                
            } catch (error) {
                console.error('Error loading articles:', error);
                loadDefaultArticles();
            }
        }
        
        function displayArticleCategories() {
            const categoriesContainer = document.getElementById('articleCategories');
            if (!categoriesContainer) return;
            
            // إضافة فئة "الكل" في البداية
            let categoriesHTML = '<button class="filter-btn active" onclick="filterArticles(\'all\')">الكل</button>';
            
            // إضافة الفئات الأخرى
            articleCategories.forEach(category => {
                if (category && category.trim() !== '') {
                    categoriesHTML += `<button class="filter-btn" onclick="filterArticles('${category}')">${category}</button>`;
                }
            });
            
            categoriesContainer.innerHTML = categoriesHTML;
        }
        
        function displayArticles(articles) {
            const articlesContainer = document.getElementById('articlesList');
            if (!articlesContainer) return;
            
            articlesContainer.innerHTML = '';
            
            if (!articles || articles.length === 0) {
                articlesContainer.innerHTML = '<p style="text-align: center; color: #aaa; grid-column: 1 / -1; padding: 40px;">لا توجد مقالات متاحة حالياً</p>';
                return;
            }
            
            articles.forEach(article => {
                const articleCard = document.createElement('div');
                articleCard.className = 'article-card glass-effect';
                articleCard.onclick = () => openArticle(article);
                
                const excerpt = article.description ? 
                    (article.description.length > 150 ? article.description.substring(0, 150) + '...' : article.description) :
                    'لا يوجد وصف للمقالة';
                
                articleCard.innerHTML = `
                    <div class="article-category">${article.category_name || 'عام'}</div>
                    <h3 class="article-title">${article.title || 'عنوان المقالة'}</h3>
                    <p class="article-excerpt">${excerpt}</p>
                    <div class="article-meta">
                        <span><i class="far fa-calendar"></i> ${article.created_at ? article.created_at.substring(0, 10) : 'تاريخ غير معروف'}</span>
                        <span><i class="far fa-eye"></i> ${article.views || 0}</span>
                    </div>
                `;
                
                articlesContainer.appendChild(articleCard);
            });
        }
        
        function loadDefaultArticles() {
            const defaultArticles = [
                {
                    title: 'فضل الصلاة في الإسلام',
                    description: 'مقال يتحدث عن أهمية الصلاة وفضلها في الإسلام',
                    category_name: 'الصلاة',
                    created_at: '2024-01-15',
                    views: 1250
                },
                {
                    title: 'أهمية بر الوالدين',
                    description: 'مقال يتناول أهمية بر الوالدين في الإسلام',
                    category_name: 'الأخلاق',
                    created_at: '2024-01-10',
                    views: 980
                }
            ];
            
            islamicArticles = defaultArticles;
            displayArticles(islamicArticles);
        }
        
        function filterArticles(category) {
            const buttons = document.querySelectorAll('#articleCategories .filter-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            let filtered = islamicArticles;
            
            if (category !== 'all') {
                filtered = islamicArticles.filter(article => 
                    article.category_name === category
                );
            }
            
            displayArticles(filtered);
            audioSystem.playSound('click');
        }
        
        function searchArticles() {
            const searchInput = document.getElementById('searchArticles');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            
            if (!searchTerm) {
                displayArticles(islamicArticles);
                return;
            }
            
            const filtered = islamicArticles.filter(article => 
                (article.title && article.title.toLowerCase().includes(searchTerm)) ||
                (article.description && article.description.toLowerCase().includes(searchTerm)) ||
                (article.category_name && article.category_name.toLowerCase().includes(searchTerm))
            );
            
            displayArticles(filtered);
        }
        
        function openArticle(article) {
            // فتح المقال في نافذة جديدة إذا كان هناك رابط
            if (article.link) {
                window.open(article.link, '_blank');
            } else {
                // عرض محتوى المقال في نافذة منبثقة
                const articleContent = `
                    <h3 style="color: var(--gold); margin-bottom: 15px;">${article.title}</h3>
                    <div style="color: #aaa; margin-bottom: 10px;">
                        <span><i class="far fa-calendar"></i> ${article.created_at || 'غير معروف'}</span>
                        <span style="margin-right: 15px;"><i class="far fa-eye"></i> ${article.views || 0}</span>
                        <span class="article-category">${article.category_name || 'عام'}</span>
                    </div>
                    <div style="color: var(--light-text); line-height: 1.8; font-size: 1.1rem;">
                        ${article.description || 'لا يوجد محتوى للمقالة'}
                    </div>
                `;
                
                showNotification(article.title, 'تم فتح المقال. يمكنك قراءته بالكامل');
                
                // إنشاء نافذة عرض المقال
                const articleModal = document.createElement('div');
                articleModal.style.position = 'fixed';
                articleModal.style.top = '0';
                articleModal.style.left = '0';
                articleModal.style.width = '100%';
                articleModal.style.height = '100%';
                articleModal.style.background = 'rgba(0,0,0,0.8)';
                articleModal.style.zIndex = '1001';
                articleModal.style.display = 'flex';
                articleModal.style.justifyContent = 'center';
                articleModal.style.alignItems = 'center';
                articleModal.style.padding = '20px';
                
                articleModal.innerHTML = `
                    <div class="card glass-effect" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: var(--gold);">${article.title}</h3>
                            <button class="btn btn-secondary" onclick="this.parentElement.parentElement.parentElement.remove()">
                                <i class="fas fa-times"></i> إغلاق
                            </button>
                        </div>
                        ${articleContent}
                    </div>
                `;
                
                document.body.appendChild(articleModal);
            }
            audioSystem.playSound('notification');
        }
        
        // ==================== نظام الأحكام الشرعية من ملفات CSV بشكل منفصل ====================
        async function loadFatawaFromCSV() {
            try {
                // إظهار حالة التحميل
                const loadingDiv = document.getElementById('fatawaLoading');
                const fatawaList = document.getElementById('fatawaList');
                
                loadingDiv.style.display = 'block';
                fatawaList.innerHTML = '';
                
                // مسارات ملفات CSV على GitHub
                const baseURL = 'https://raw.githubusercontent.com/mj69077/ra3d/main/';
                const csvFiles = [
                    { name: 'questions', url: baseURL + 'questions.csv', data: [] },
                    { name: 'answers', url: baseURL + 'answers.csv', data: [] },
                    { name: 'titles', url: baseURL + 'titles.csv', data: [] },
                    { name: 'links', url: baseURL + 'links.csv', data: [] },
                    { name: 'categories', url: baseURL + 'categories.csv', data: [] }
                ];
                
                // دالة لتحميل ملف CSV فردي
                async function loadSingleCSV(file) {
                    try {
                        const response = await fetch(file.url);
                        if (!response.ok) {
                            throw new Error(`فشل تحميل: ${file.name}`);
                        }
                        const text = await response.text();
                        file.data = parseCSV(text);
                        console.log(`✅ تم تحميل ${file.name}: ${file.data.length} سطر`);
                        return { success: true, file: file.name, count: file.data.length };
                    } catch (error) {
                        console.error(`❌ خطأ في تحميل ${file.name}:`, error);
                        return { success: false, file: file.name, error: error.message };
                    }
                }
        
                // دالة لتحليل محتوى CSV
                function parseCSV(csvText) {
                    if (!csvText || csvText.trim() === '') {
                        return [];
                    }
                    
                    const lines = csvText.split('\n');
                    const result = [];
                    
                    for (let i = 0; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (line && i > 0) { // تخطي العنوان الأول (الرأس)
                            // إزالة الاقتباسات إذا وجدت
                            const cleanLine = line.replace(/^"|"$/g, '');
                            result.push(cleanLine);
                        }
                    }
                    
                    return result;
                }
                
                // تحميل الملفات بشكل تسلسلي مع عرض التقدم
                let loadedCount = 0;
                const totalFiles = csvFiles.length;
                
                // تحديث حالة التحميل
                const updateLoadingStatus = () => {
                    loadedCount++;
                    const progress = Math.round((loadedCount / totalFiles) * 100);
                    console.log(`📊 التقدم: ${progress}% (${loadedCount}/${totalFiles})`);
                    
                    // تحديث واجهة المستخدم إذا أردت
                    // document.getElementById('loadingProgress').style.width = `${progress}%`;
                };
                
                // تحميل كل ملف على حدة
                console.log('🚀 بدء تحميل ملفات CSV...');
                
                for (let i = 0; i < csvFiles.length; i++) {
                    const file = csvFiles[i];
                    console.log(`📥 جاري تحميل ${file.name}...`);
                    
                    const result = await loadSingleCSV(file);
                    updateLoadingStatus();
                    
                    if (!result.success) {
                        console.warn(`⚠️ تحذير: ${result.error}`);
                        // استمر في تحميل الملفات الأخرى حتى لو فشل أحدها
                    }
                }
                
                console.log('✅ اكتمل تحميل جميع الملفات');
                
                // العثور على الحد الأدنى لعدد الأسطر المشتركة بين الملفات
                const minLength = Math.min(
                    ...csvFiles.map(file => file.data.length)
                );
                
                console.log(`📊 عدد الأسطر المتاحة: ${minLength}`);
                
                // إذا لم توجد بيانات كافية، استخدم البيانات الافتراضية
                if (minLength === 0) {
                    console.log('⚠️ لا توجد بيانات كافية في ملفات CSV، استخدام البيانات الافتراضية');
                    loadDefaultFatawa();
                    loadingDiv.style.display = 'none';
                    return;
                }
                
                // دمج البيانات
                allFatawa = [];
                for (let i = 0; i < minLength; i++) {
                    allFatawa.push({
                        'السؤال': csvFiles[0].data[i] || `سؤال ${i + 1}`,
                        'الجواب': csvFiles[1].data[i] || 'جواب غير متوفر',
                        'العنوان': csvFiles[2].data[i] || `فتوى ${i + 1}`,
                        'الرابط': csvFiles[3].data[i] || '#',
                        'الفئة': csvFiles[4].data[i] || 'عام'
                    });
                }
                
                console.log(`✅ تم دمج ${allFatawa.length} فتوى`);
                
                // استخراج الفئات
                fatawaCategories.clear();
                allFatawa.forEach(fatawa => {
                    if (fatawa['الفئة'] && fatawa['الفئة'].trim() !== '') {
                        fatawaCategories.add(fatawa['الفئة']);
                    }
                });
                
                // عرض الفئات
                displayFatawaCategories();
                
                // عرض جميع الأحكام
                displayFatawa(allFatawa);
                
                showNotification('تم', `تم تحميل ${allFatawa.length} حكم شرعي من ملفات CSV`);
                console.log(`🎉 تم تحميل ${allFatawa.length} فتوى بنجاح`);
                
                loadingDiv.style.display = 'none';
                
            } catch (error) {
                console.error('❌ خطأ عام في تحميل الفتاوى من CSV:', error);
                showNotification('تنبيه', 'تم تحميل الفتاوى من مصدر محلي');
                
                // استخدام البيانات الافتراضية
                loadDefaultFatawa();
                
                const loadingDiv = document.getElementById('fatawaLoading');
                loadingDiv.style.display = 'none';
            }
        }
        
        function loadDefaultFatawa() {
            allFatawa = [
                {
                    'السؤال': 'ما حكم الصلاة بدون وضوء؟',
                    'الجواب': 'الصلاة بدون وضوء باطلة ولا تقبل. قال الله تعالى: {يَا أَيُّهَا الَّذِينَ آمَنُوا إِذَا قُمْتُمْ إِلَى الصَّلَاةِ فَاغْسِلُوا وُجُوهَكُمْ وَأَيْدِيَكُمْ إِلَى الْمَرَافِقِ وَامْسَحُوا بِرُؤُوسِكُمْ وَأَرْجُلَكُمْ إِلَى الْكَعْبَيْنِ} [المائدة: 6]. وقال رسول الله صلى الله عليه وسلم: "لا يقبل الله صلاة أحدكم إذا أحدث حتى يتوضأ" (رواه البخاري ومسلم).',
                    'العنوان': 'حكم الصلاة بدون وضوء',
                    'الرابط': '#',
                    'الفئة': 'الصلاة'
                },
                {
                    'السؤال': 'ما هي شروط الزكاة؟',
                    'الجواب': 'شروط الزكاة خمسة: الإسلام، الحرية، ملك النصاب، الحول، النماء. النصاب الشرعي يختلف باختلاف نوع المال.',
                    'العنوان': 'شروط وجوب الزكاة',
                    'الرابط': '#',
                    'الفئة': 'الزكاة'
                },
                {
                    'السؤال': 'ما حكم من أفطر في رمضان بدون عذر؟',
                    'الجواب': 'من أفطر في رمضان بدون عذر شرعي فقد ارتكب إثماً عظيماً، وعليه التوبة إلى الله وقضاء اليوم الذي أفطره.',
                    'العنوان': 'حكم الإفطار في رمضان بلا عذر',
                    'الرابط': '#',
                    'الفئة': 'الصيام'
                },
                {
                    'السؤال': 'حكم العمل في البنوك الربوية',
                    'الجواب': 'العمل في البنوك الربوية محرم إذا كان يتعلق بالربا مباشرة. قال تعالى: {يَا أَيُّهَا الَّذِينَ آمَنُوا اتَّقُوا اللَّهَ وَذَرُوا مَا بَقِيَ مِنَ الرِّبَا} [البقرة: 278].',
                    'العنوان': 'حكم العمل في البنوك',
                    'الرابط': '#',
                    'الفئة': 'المعاملات'
                },
                {
                    'السؤال': 'حكم لبس الذهب للرجال',
                    'الجواب': 'يحرم على الرجال لبس الذهب سواء كان خاتماً أو ساعة أو غيره. أما النساء فيجوز لهن لبس الذهب.',
                    'العنوان': 'حكم لبس الذهب للرجال',
                    'الرابط': '#',
                    'الفئة': 'اللباس'
                },
                {
                    'السؤال': 'ما حكم الصلاة في السيارة؟',
                    'الجواب': 'يجوز للمسافر أن يصلي النوافل في السيارة إذا تعذر النزول، أما الفريضة فلا تصح إلا في الأرض.',
                    'العنوان': 'حكم الصلاة في السيارة',
                    'الرابط': '#',
                    'الفئة': 'الصلاة'
                },
                {
                    'السؤال': 'ما حكم تأخير الزكاة؟',
                    'الجواب': 'تأخير إخراج الزكاة مع القدرة محرم، وعليه إثم التأخير مع لزوم إخراجها.',
                    'العنوان': 'حكم تأخير الزكاة',
                    'الرابط': '#',
                    'الفئة': 'الزكاة'
                },
                {
                    'السؤال': 'ما حكم السحور في رمضان؟',
                    'الجواب': 'السحور مستحب وليس واجباً، وله فضل عظيم. قال صلى الله عليه وسلم: "تسحروا فإن في السحور بركة" (رواه البخاري ومسلم).',
                    'العنوان': 'فضل السحور وحكمه',
                    'الرابط': '#',
                    'الفئة': 'الصيام'
                }
            ];
            
            // استخراج الفئات
            fatawaCategories.clear();
            allFatawa.forEach(fatawa => {
                if (fatawa['الفئة']) {
                    fatawaCategories.add(fatawa['الفئة']);
                }
            });
            
            // عرض الفئات
            displayFatawaCategories();
            
            // عرض الأحكام
            displayFatawa(allFatawa);
        }
        
        function displayFatawaCategories() {
            const categoriesContainer = document.getElementById('fatawaCategories');
            if (!categoriesContainer) return;
            
            // إضافة فئة "الكل" في البداية
            let categoriesHTML = '<button class="filter-btn active" onclick="filterFatawa(\'all\')">الكل</button>';
            
            // إضافة الفئات الأخرى
            fatawaCategories.forEach(category => {
                if (category && category.trim() !== '') {
                    categoriesHTML += `<button class="filter-btn" onclick="filterFatawa('${category}')">${category}</button>`;
                }
            });
            
            categoriesContainer.innerHTML = categoriesHTML;
        }
        
        function displayFatawa(fatawaList) {
            const fatawaContainer = document.getElementById('fatawaList');
            const noResultsDiv = document.getElementById('noFatawaResults');
            
            if (!fatawaContainer) return;
            
            fatawaContainer.innerHTML = '';
            
            if (!fatawaList || fatawaList.length === 0) {
                noResultsDiv.style.display = 'block';
                return;
            }
            
            noResultsDiv.style.display = 'none';
            
            fatawaList.forEach((fatawa, index) => {
                const fatawaCard = document.createElement('div');
                fatawaCard.className = 'fatawa-card glass-effect';
                fatawaCard.onclick = () => showFatawaDetail(fatawa);
                
                const question = fatawa['السؤال'] || fatawa['سؤال'] || 'سؤال غير متوفر';
                const category = fatawa['الفئة'] || fatawa['فئة'] || 'عام';
                const title = fatawa['العنوان'] || `فتوى ${index + 1}`;
                
                // تقصير السؤال إذا كان طويلاً
                const shortQuestion = question.length > 100 ? question.substring(0, 100) + '...' : question;
                
                fatawaCard.innerHTML = `
                    <div>
                        <div class="fatawa-category">${category}</div>
                        <h3 class="fatawa-question">${title}</h3>
                        <div style="color: #aaa; font-size: 0.95rem; line-height: 1.6; margin-top: 10px;">
                            ${shortQuestion}
                        </div>
                    </div>
                    <div class="fatawa-details">
                        <div><i class="fas fa-book"></i> ${category}</div>
                        <div><i class="fas fa-chevron-left"></i></div>
                    </div>
                `;
                
                fatawaContainer.appendChild(fatawaCard);
            });
        }
        
        function filterFatawa(category) {
            const buttons = document.querySelectorAll('#fatawaCategories .filter-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            let filtered = allFatawa;
            
            if (category !== 'all') {
                filtered = allFatawa.filter(fatawa => 
                    fatawa['الفئة'] === category
                );
            }
            
            displayFatawa(filtered);
            audioSystem.playSound('click');
        }
        
        function searchFatawa() {
            const searchInput = document.getElementById('searchFatawa');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            
            if (!searchTerm) {
                displayFatawa(allFatawa);
                return;
            }
            
            const filtered = allFatawa.filter(fatawa => 
                (fatawa['السؤال'] && fatawa['السؤال'].toLowerCase().includes(searchTerm)) ||
                (fatawa['الجواب'] && fatawa['الجواب'].toLowerCase().includes(searchTerm)) ||
                (fatawa['العنوان'] && fatawa['العنوان'].toLowerCase().includes(searchTerm)) ||
                (fatawa['الفئة'] && fatawa['الفئة'].toLowerCase().includes(searchTerm))
            );
            
            displayFatawa(filtered);
            
            // إظهار رسالة إذا لم توجد نتائج
            const noResultsDiv = document.getElementById('noFatawaResults');
            if (filtered.length === 0) {
                noResultsDiv.style.display = 'block';
                noResultsDiv.innerHTML = `
                    <i class="fas fa-search" style="font-size: 3rem; color: #666; margin-bottom: 15px;"></i>
                    <p>لا توجد أحكام مطابقة للبحث: "${searchTerm}"</p>
                `;
            } else {
                noResultsDiv.style.display = 'none';
            }
        }
        
        function showFatawaDetail(fatawa) {
            const modal = document.getElementById('fatawaDetailModal');
            const title = document.getElementById('fatawaDetailTitle');
            const content = document.getElementById('fatawaDetailContent');
            const source = document.getElementById('fatawaDetailSource');
            
            const question = fatawa['السؤال'] || fatawa['سؤال'] || 'سؤال غير متوفر';
            const answer = fatawa['الجواب'] || fatawa['جواب'] || 'جواب غير متوفر';
            const category = fatawa['الفئة'] || fatawa['فئة'] || 'عام';
            const fatawaTitle = fatawa['العنوان'] || question.substring(0, 50) + '...';
            const link = fatawa['الرابط'] || '#';
            
            title.textContent = fatawaTitle;
            
            content.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <div class="fatawa-category">${category}</div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--light-text); margin-bottom: 10px;">السؤال:</h3>
                    <div style="color: var(--light-text); background: rgba(255,215,0,0.1); padding: 15px; border-radius: 10px; border-right: 3px solid var(--gold);">
                        ${question}
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--light-text); margin-bottom: 10px;">الجواب:</h3>
                    <div class="fatawa-answer">
                        ${answer.replace(/\n/g, '<br>')}
                    </div>
                </div>
            `;
            
            source.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <i class="fas fa-tag"></i> الفئة: ${category}
                    </div>
                    ${link !== '#' ? `<a href="${link}" target="_blank" style="color: var(--gold);"><i class="fas fa-external-link-alt"></i> مصدر الفتوى</a>` : ''}
                </div>
            `;
            
            modal.style.display = 'flex';
            audioSystem.playSound('notification');
        }
        
        function closeFatawaDetail() {
            const modal = document.getElementById('fatawaDetailModal');
            modal.style.display = 'none';
            audioSystem.playSound('click');
        }
        
        function copyFatawaDetail() {
            const title = document.getElementById('fatawaDetailTitle').textContent;
            const question = document.querySelector('.fatawa-answer').previousElementSibling.querySelector('div').textContent;
            const answer = document.querySelector('.fatawa-answer').textContent;
            
            const textToCopy = `${title}\n\nالسؤال:\n${question}\n\nالجواب:\n${answer}`;
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        showNotification('تم النسخ', 'تم نسخ الحكم الشرعي');
                        audioSystem.playSound('notification');
                    })
                    .catch(() => showNotification('خطأ', 'تعذر نسخ النص'));
            } else {
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('تم النسخ', 'تم نسخ الحكم الشرعي');
                audioSystem.playSound('notification');
            }
        }
        
        function shareFatawaDetail() {
            const title = document.getElementById('fatawaDetailTitle').textContent;
            const question = document.querySelector('.fatawa-answer').previousElementSibling.querySelector('div').textContent;
            const answer = document.querySelector('.fatawa-answer').textContent;
            
            const shareText = `${title}\n\nالسؤال:\n${question}\n\nالجواب:\n${answer}\n\nمشاركة من تطبيق رعد الإسلامي`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'فتوى شرعية من تطبيق رعد',
                    text: shareText,
                    url: window.location.href
                }).catch(() => {
                    // إذا فشلت المشاركة، استخدم النسخ
                    copyFatawaDetail();
                });
            } else {
                copyFatawaDetail();
            }
        }
        
        // ==================== نظام السمات ====================
        function selectTheme(theme) {
            // تحديث فئة body لتحميل الثيم الجديد
            document.body.className = `theme-${theme}`;
            
            // تحديث شاشة التحميل مع الثيم الجديد
            initLoadingScreen();
            
            // تحديث الأزرار النشطة
            document.querySelectorAll('.theme-card').forEach(card => {
                card.classList.remove('active');
            });
            
            if (event && event.target) {
                const card = event.target.closest('.theme-card');
                if (card) {
                    card.classList.add('active');
                }
            }
            
            // حفظ الثيم في localStorage
            localStorage.setItem('theme', theme);
            
            const themeDescriptions = {
                'gold': 'المظهر الذهبي الافتراضي',
                'green': 'لون  - الاخضرار والنقاء',
                'blue': 'لون السماء - الصفاء والسلام',
                'purple': 'لون الملكي - الفخامة والجمال',
                'brown': 'لون الأرض - الاستقرار والطمأنينة',
                'pink': 'لون الرقة - اللطف والهدوء',
                'red': 'لون القوة - الطاقة والعزم',
                'yellow': 'لون الشمس - النور والدفء',
                'orange': 'لون الطاقة - الحيوية والنشاط',
                'white': 'للقراءة النهارية - الوضوح والراحة',
                'gray': 'لون الجبال - الثبات والوقار',
                'cherry': 'لون الكرز - الحلاوة والجمال',
                'wine': 'لون العميق - الغموض والأناقة',
                'icy': 'لون الجليد - النقاء والصفاء'
            };
            
            showNotification('تم التغيير', themeDescriptions[theme] || `تم تطبيق السمة ${theme}`);
            audioSystem.playSound('section');
        }
        
        function resetTheme() {
            selectTheme('gold');
        }
        
        // ==================== وظائف مساعدة ====================
        function showSection(id) {
            // إخفاء جميع الأقسام
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active-section');
            });
            
            // إزالة النشاط من أزرار التنقل
            document.querySelectorAll('nav button').forEach(button => {
                button.classList.remove('active');
            });
            
            // إزالة النشاط من أزرار الفوتر
            document.querySelectorAll('.footer-btn').forEach(button => {
                button.classList.remove('active');
            });
            
            // إظهار القسم المطلوب
            const section = document.getElementById(id);
            if (section) {
                section.classList.add('active-section');
            }
            
            // تحديث أزرار التنقل
            const navButton = document.getElementById(`m-${id}`);
            if (navButton) {
                navButton.classList.add('active');
            }
            
            // تحديث أزرار الفوتر
            const footerButtons = document.querySelectorAll(`.footer-btn[onclick*="${id}"]`);
            footerButtons.forEach(button => {
                button.classList.add('active');
            });
            
            audioSystem.playSound('section');
        }
        
        function showNotification(title, message) {
            // إزالة الإشعارات القديمة
            document.querySelectorAll('.notification').forEach(notification => {
                notification.remove();
            });
            
            const notification = document.createElement('div');
            notification.className = 'notification glass-effect';
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-info-circle" style="color: var(--gold);"></i>
                    <div>
                        <strong>${title}</strong><br>
                        <span style="color: #aaa;">${message}</span>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
        }
        
        function applyGlassEffect() {
            setTimeout(() => {
                document.querySelectorAll('.card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.prayer-time-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.surah-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.asma-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.radio-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.article-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.fatawa-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
                
                document.querySelectorAll('.ayah-result-card').forEach(card => {
                    if (!card.classList.contains('glass-effect')) {
                        card.classList.add('glass-effect');
                    }
                });
            }, 100);
        }
        
        function loadSettings() {
            // تحميل السمة
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.body.className = `theme-${savedTheme}`;
                
                document.querySelectorAll('.theme-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                const activeCard = document.querySelector(`.theme-card[onclick*="${savedTheme}"]`);
                if (activeCard) {
                    activeCard.classList.add('active');
                }
            }
            
            // تحميل إحصائيات المسبحة
            const savedStats = localStorage.getItem('tasbihStats');
            if (savedStats) {
                try {
                    tasbihStats = JSON.parse(savedStats);
                    const todaySubhan = document.getElementById('todaySubhan');
                    const todayHamd = document.getElementById('todayHamd');
                    const todayTakbir = document.getElementById('todayTakbir');
                    
                    if (todaySubhan) todaySubhan.textContent = tasbihStats.subhan || 0;
                    if (todayHamd) todayHamd.textContent = tasbihStats.hamd || 0;
                    if (todayTakbir) todayTakbir.textContent = tasbihStats.takbir || 0;
                } catch (e) {
                    console.error('Error parsing stats:', e);
                }
            }
            
            // تحميل إعدادات الصلاة
            const savedPrayerSettings = localStorage.getItem('prayerSettings');
            if (savedPrayerSettings) {
                try {
                    prayerSettings = JSON.parse(savedPrayerSettings);
                    
                    const cityInput = document.getElementById('cityInput');
                    const countryInput = document.getElementById('countryInput');
                    
                    if (cityInput) cityInput.value = prayerSettings.city || 'مكة';
                    if (countryInput) countryInput.value = prayerSettings.country || 'السعودية';
                } catch (e) {
                    console.error('Error parsing prayer settings:', e);
                }
            }
        }
        
        function saveStats() {
            localStorage.setItem('tasbihStats', JSON.stringify(tasbihStats));
        }
        
        function saveSettings() {
            const cityInput = document.getElementById('cityInput');
            const countryInput = document.getElementById('countryInput');
            
            if (cityInput) prayerSettings.city = cityInput.value;
            if (countryInput) prayerSettings.country = countryInput.value;
            
            localStorage.setItem('prayerSettings', JSON.stringify(prayerSettings));
        }
    </script>
</body>
</html>